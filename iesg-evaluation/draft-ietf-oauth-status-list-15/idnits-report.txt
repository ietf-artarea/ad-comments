idnits 2.17.1 

draft-ietf-oauth-status-list-15.txt:
-(198): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(199): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(200): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(201): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(232): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(233): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(234): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(236): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(238): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(240): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(241): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(242): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(758): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(945): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1368): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1372): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1374): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1375): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1376): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1377): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1378): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1379): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1380): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1383): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1519): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1520): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1521): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1539): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1541): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1923): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1925): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1926): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1927): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1928): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1929): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1930): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1931): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1932): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1933): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1934): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding
-(1935): Line appears to be too long, but this could be caused by non-ascii characters in UTF-8 encoding

  Showing Errors (**), Flaws (~~), Warnings (==), and Comments (--).
  Errors MUST be fixed before draft submission.  Flaws SHOULD be fixed before draft submission.

  Checking boilerplate required by RFC 5378 and the IETF Trust (see
  https://trustee.ietf.org/license-info):
  ----------------------------------------------------------------------------

     No issues found here.

  Checking nits according to https://www.ietf.org/id-info/1id-guidelines.txt:
  ----------------------------------------------------------------------------

  == There are 101 instances of lines with non-ascii characters in the
     document.


  Running in submission checking mode -- *not* checking nits according to
  https://www.ietf.org/id-info/checklist .
  ----------------------------------------------------------------------------


     Summary: 0 errors (**), 0 flaws (~~), 1 warning (==), 0 comments (--).

--------------------------------------------------------------------------------


2	Web Authorization Protocol                                     T. Looker
3	Internet-Draft                                                     MATTR
4	Intended status: Standards Track                              P. Bastian
5	Expires: 10 July 2026                                    Bundesdruckerei
6	                                                              C. Bormann
7	                                                                  SPRIND
8	                                                          6 January 2026

10	                        Token Status List (TSL)
11	                    draft-ietf-oauth-status-list-15

13	Abstract

15	   This specification defines a status mechanism called Token Status
16	   List (TSL), data structures and processing rules for representing the
17	   status of tokens secured by JSON Object Signing and Encryption (JOSE)
18	   or CBOR Object Signing and Encryption (COSE), such as JWT, SD-JWT VC,
19	   CBOR Web Token, and ISO mdoc.  It also defines an extension point and
20	   a registry for future status mechanisms.

22	About This Document

24	   This note is to be removed before publishing as an RFC.

26	   The latest revision of this draft can be found at https://oauth-
27	   wg.github.io/draft-ietf-oauth-status-list/draft-ietf-oauth-status-
28	   list.html.  Status information for this document may be found at
29	   https://datatracker.ietf.org/doc/draft-ietf-oauth-status-list/.

31	   Discussion of this document takes place on the Web Authorization
32	   Protocol Working Group mailing list (mailto:oauth@ietf.org), which is
33	   archived at https://mailarchive.ietf.org/arch/browse/oauth/.
34	   Subscribe at https://www.ietf.org/mailman/listinfo/oauth/.

36	   Source for this draft and an issue tracker can be found at
37	   https://github.com/oauth-wg/draft-ietf-oauth-status-list.

39	Status of This Memo

41	   This Internet-Draft is submitted in full conformance with the
42	   provisions of BCP 78 and BCP 79.

44	   Internet-Drafts are working documents of the Internet Engineering
45	   Task Force (IETF).  Note that other groups may also distribute
46	   working documents as Internet-Drafts.  The list of current Internet-
47	   Drafts is at https://datatracker.ietf.org/drafts/current/.

49	   Internet-Drafts are draft documents valid for a maximum of six months
50	   and may be updated, replaced, or obsoleted by other documents at any
51	   time.  It is inappropriate to use Internet-Drafts as reference
52	   material or to cite them other than as "work in progress."

54	   This Internet-Draft will expire on 10 July 2026.

56	Copyright Notice

58	   Copyright (c) 2026 IETF Trust and the persons identified as the
59	   document authors.  All rights reserved.

61	   This document is subject to BCP 78 and the IETF Trust's Legal
62	   Provisions Relating to IETF Documents (https://trustee.ietf.org/
63	   license-info) in effect on the date of publication of this document.
64	   Please review these documents carefully, as they describe your rights
65	   and restrictions with respect to this document.  Code Components
66	   extracted from this document must include Revised BSD License text as
67	   described in Section 4.e of the Trust Legal Provisions and are
68	   provided without warranty as described in the Revised BSD License.

70	Table of Contents

72	   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4
73	     1.1.  Example Use Cases . . . . . . . . . . . . . . . . . . . .   6
74	     1.2.  Rationale . . . . . . . . . . . . . . . . . . . . . . . .   6
75	     1.3.  Design Considerations . . . . . . . . . . . . . . . . . .   7
76	     1.4.  Prior Work  . . . . . . . . . . . . . . . . . . . . . . .   8
77	     1.5.  Status Mechanisms Registry  . . . . . . . . . . . . . . .   8
78	   2.  Conventions and Definitions . . . . . . . . . . . . . . . . .   8
79	   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   8
80	   4.  Status List . . . . . . . . . . . . . . . . . . . . . . . . .   9
81	     4.1.  Compressed Byte Array . . . . . . . . . . . . . . . . . .   9
82	     4.2.  Status List in JSON Format  . . . . . . . . . . . . . . .  11
83	     4.3.  Status List in CBOR Format  . . . . . . . . . . . . . . .  12
84	   5.  Status List Token . . . . . . . . . . . . . . . . . . . . . .  14
85	     5.1.  Status List Token in JWT Format . . . . . . . . . . . . .  14
86	     5.2.  Status List Token in CWT Format . . . . . . . . . . . . .  15
87	   6.  Referenced Token  . . . . . . . . . . . . . . . . . . . . . .  17
88	     6.1.  Status Claim  . . . . . . . . . . . . . . . . . . . . . .  17
89	     6.2.  Referenced Token in JOSE  . . . . . . . . . . . . . . . .  17
90	     6.3.  Referenced Token in COSE  . . . . . . . . . . . . . . . .  19
91	       6.3.1.  CBOR Web Token (CWT)  . . . . . . . . . . . . . . . .  20
92	       6.3.2.  ISO mdoc  . . . . . . . . . . . . . . . . . . . . . .  21
93	   7.  Status Types  . . . . . . . . . . . . . . . . . . . . . . . .  24
94	     7.1.  Status Types Values . . . . . . . . . . . . . . . . . . .  25
95	   8.  Verification and Processing . . . . . . . . . . . . . . . . .  25
96	     8.1.  Status List Request . . . . . . . . . . . . . . . . . . .  25
97	     8.2.  Status List Response  . . . . . . . . . . . . . . . . . .  26
98	     8.3.  Validation Rules  . . . . . . . . . . . . . . . . . . . .  27
99	     8.4.  Historical Resolution . . . . . . . . . . . . . . . . . .  29
100	   9.  Status List Aggregation . . . . . . . . . . . . . . . . . . .  30
101	     9.1.  Issuer Metadata . . . . . . . . . . . . . . . . . . . . .  31
102	     9.2.  Status List Parameter . . . . . . . . . . . . . . . . . .  31
103	     9.3.  Status List Aggregation Data Structure  . . . . . . . . .  31
104	   10. X.509 Certificate Extended Key Usage Extension  . . . . . . .  32
105	   11. Security Considerations . . . . . . . . . . . . . . . . . . .  32
106	     11.1.  Correct decoding and parsing of the encoded Status
107	            List . . . . . . . . . . . . . . . . . . . . . . . . . .  33
108	     11.2.  Security Guidance for JWT and CWT  . . . . . . . . . . .  33
109	     11.3.  Key Resolution and Trust Management  . . . . . . . . . .  33
110	     11.4.  Redirection 3xx  . . . . . . . . . . . . . . . . . . . .  35
111	     11.5.  Expiration and Caching . . . . . . . . . . . . . . . . .  35
112	     11.6.  Status List Token Protection . . . . . . . . . . . . . .  35
113	   12. Privacy Considerations  . . . . . . . . . . . . . . . . . . .  35
114	     12.1.  Observability of Issuers . . . . . . . . . . . . . . . .  35
115	     12.2.  Issuer Tracking of Referenced Tokens . . . . . . . . . .  36
116	     12.3.  Observability of Relying Parties . . . . . . . . . . . .  37
117	     12.4.  Observability of Outsiders . . . . . . . . . . . . . . .  37
118	     12.5.  Unlinkability  . . . . . . . . . . . . . . . . . . . . .  37
119	       12.5.1.  Colluding Relying Parties  . . . . . . . . . . . . .  38
120	       12.5.2.  Colluding Status Issuer and Relying Party  . . . . .  38
121	     12.6.  External Status Provider for Privacy . . . . . . . . . .  38
122	     12.7.  Historical Resolution  . . . . . . . . . . . . . . . . .  39
123	     12.8.  Status Types . . . . . . . . . . . . . . . . . . . . . .  39
124	   13. Operational Considerations  . . . . . . . . . . . . . . . . .  39
125	     13.1.  Token Lifecycle  . . . . . . . . . . . . . . . . . . . .  39
126	     13.2.  Linkability Mitigation . . . . . . . . . . . . . . . . .  40
127	     13.3.  Default Values and Double Allocation . . . . . . . . . .  40
128	     13.4.  Status List Size . . . . . . . . . . . . . . . . . . . .  40
129	     13.5.  External Status Issuer . . . . . . . . . . . . . . . . .  41
130	     13.6.  External Status Provider for Scalability . . . . . . . .  41
131	     13.7.  Status List Update Interval and Caching  . . . . . . . .  41
132	     13.8.  Relying Parties avoiding correlatable Information  . . .  43
133	     13.9.  Status List Formats  . . . . . . . . . . . . . . . . . .  43
134	   14. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  43
135	     14.1.  JSON Web Token Claims Registration . . . . . . . . . . .  44
136	       14.1.1.  Registry Contents  . . . . . . . . . . . . . . . . .  44
137	     14.2.  JWT Status Mechanisms Registry . . . . . . . . . . . . .  44
138	       14.2.1.  Registration Template  . . . . . . . . . . . . . . .  45
139	       14.2.2.  Initial Registry Contents  . . . . . . . . . . . . .  46
140	     14.3.  CBOR Web Token Claims Registration . . . . . . . . . . .  46
141	       14.3.1.  Registry Contents  . . . . . . . . . . . . . . . . .  46
142	     14.4.  CWT Status Mechanisms Registry . . . . . . . . . . . . .  47
143	       14.4.1.  Registration Template  . . . . . . . . . . . . . . .  48
144	       14.4.2.  Initial Registry Contents  . . . . . . . . . . . . .  48

146	     14.5.  OAuth Status Types Registry  . . . . . . . . . . . . . .  48
147	       14.5.1.  Registration Template  . . . . . . . . . . . . . . .  49
148	       14.5.2.  Initial Registry Contents  . . . . . . . . . . . . .  50
149	     14.6.  OAuth Parameters Registration  . . . . . . . . . . . . .  51
150	     14.7.  Media Type Registration  . . . . . . . . . . . . . . . .  51
151	     14.8.  CoAP Content-Format Registrations  . . . . . . . . . . .  53
152	     14.9.  X.509 Certificate Extended Key Purpose OID
153	            Registration . . . . . . . . . . . . . . . . . . . . . .  53
154	   15. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  54
155	   16. References  . . . . . . . . . . . . . . . . . . . . . . . . .  54
156	     16.1.  Normative References . . . . . . . . . . . . . . . . . .  54
157	     16.2.  Informative References . . . . . . . . . . . . . . . . .  56
158	   Appendix A.  ASN.1 Module . . . . . . . . . . . . . . . . . . . .  58
159	   Appendix B.  Size Comparison  . . . . . . . . . . . . . . . . . .  58
160	     Size of Status Lists for varying amount of entries and revocation
161	           rates . . . . . . . . . . . . . . . . . . . . . . . . . .  59
162	     Size of compressed array of UUIDv4 (128-bit UUIDs) for varying
163	           amount of entries and revocation rates  . . . . . . . . .  59
164	   Appendix C.  Test vectors for Status List encoding  . . . . . . .  60
165	     C.1.  1-bit Status List . . . . . . . . . . . . . . . . . . . .  60
166	     C.2.  2-bit Status List . . . . . . . . . . . . . . . . . . . .  61
167	     C.3.  4-bit Status List . . . . . . . . . . . . . . . . . . . .  62
168	     C.4.  8-bit Status List . . . . . . . . . . . . . . . . . . . .  63
169	   Document History  . . . . . . . . . . . . . . . . . . . . . . . .  72
170	   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  79

172	1.  Introduction

174	   Token formats secured by JOSE [RFC7515] or COSE [RFC9052], such as
175	   JWTs [RFC7519], SD-JWT VCs [SD-JWT.VC], CWTs [RFC8392] and ISO mdoc
176	   [ISO.mdoc], have vast possible applications.  Some of these
177	   applications can involve issuing a token whereby certain semantics
178	   about the token or its validity may change over time.  Communicating
179	   these changes to relying parties in an interoperable manner, such as
180	   whether the token is considered invalidated or suspended by its
181	   issuer is important for many of these applications.

183	   This document defines a Status List data structure that describes the
184	   individual statuses of multiple Referenced Tokens.  A Referenced
185	   Token may be of any format, but is most commonly a data structure
186	   secured by JOSE or COSE.  The Referenced Token is referenced by the
187	   Status List, which describes the status of the Referenced Token.  The
188	   statuses of all Referenced Tokens are conveyed via a bit array in the
189	   Status List.  Each Referenced Token is allocated an index during
190	   issuance that represents its position within this bit array.  The
191	   value of the bit(s) at this index corresponds to the Referenced
192	   Token's status.  A Status List is provided within a Status List Token
193	   protected by cryptographic signature or MAC and this document defines
194	   its representations in JWT and CWT format.

196	   The following diagram depicts the relationship between the artifacts:

198	   ┌────────────────┐  describes status ┌──────────────────┐
199	   │  Status List   ├──────────────────►│ Referenced Token │
200	   │ (JSON or CBOR) │◄──────────────────┤ (JOSE, COSE, ..) │
201	   └─────┬──────────┘    references     └──────────────────┘
202	         │
203	         │ embedded in
204	         ▼
205	   ┌───────────────────┐
206	   │ Status List Token │
207	   │  (JWT or CWT)     │
208	   └───────────────────┘

210	   An Issuer issues Referenced Tokens to a Holder, the Holder uses and
211	   presents those Referenced Tokens to a Relying Party.  The Issuer
212	   gives updated status information to the Status Issuer, who issues a
213	   Status List Token.  The Status Issuer can be either the Issuer or an
214	   entity that has been authorized by the Issuer to issue Status List
215	   Tokens.  The Status Issuer provides the Status List Token to the
216	   Status Provider, who serves the Status List Token on a public,
217	   resolvable endpoint.  The Relying Party or the Holder may fetch the
218	   Status List Token to retrieve the status of the Referenced Token.

220	   The roles of the Issuer (of the Referenced Token), the Status Issuer
221	   and the Status Provider may be fulfilled by the same entity.  If not
222	   further specified, the term Issuer may refer to an entity acting for
223	   all three roles.  This document describes how an Issuer references a
224	   Status List Token and how a Relying Party fetches and validates
225	   Status Lists.

227	   The following diagram depicts the relationship between the involved
228	   roles (Relying Party is equivalent to Verifier of [SD-JWT.VC]):

230	              issue                 present
231	              Referenced            Referenced
232	   ┌────────┐ Token      ┌────────┐ Token      ┌───────────────┐
233	   │ Issuer ├───────────►│ Holder ├───────────►│ Relying Party │
234	   └─┬──────┘            └───┬────┘            └──┬────────────┘
235	     ▼ provide status        │                    │
236	   ┌───────────────┐         │                    │
237	   │ Status Issuer │         │                    │
238	   └─┬─────────────┘         │                    │
239	     ▼ provide Status List   │                    │
240	   ┌─────────────────┐       │                    │
241	   │ Status Provider │◄──────┴────────────────────┘
242	   └─────────────────┘     fetch Status List Token

244	   Status Lists can be used to express a variety of Status Types.  This
245	   document defines basic Status Types for the most common use cases as
246	   well as an extensibility mechanism for custom Status Types.

248	   Furthermore, the document creates an extension point and an IANA
249	   registry that enables other specifications to describe additional
250	   status mechanisms.

252	1.1.  Example Use Cases

254	   An example of the usage of a Status List is to manage the statuses of
255	   issued access tokens as defined in Section 1.4 of [RFC6749].  Token
256	   Introspection [RFC7662] provides a method to determine the status of
257	   an issued access token, but it necessitates the party attempting to
258	   validate the state of access tokens to directly contact the Issuer of
259	   each token for validation.  In contrast, the mechanism defined in
260	   this specification allows a party to retrieve the statuses for many
261	   tokens, reducing interactions with the Issuer substantially.  This
262	   not only improves scalability but also enhances privacy by preventing
263	   the Issuer from gaining knowledge of access tokens being verified
264	   (herd anonymity).

266	   Another possible use case for the Status List is to express the
267	   status of verifiable credentials (Referenced Tokens) issued by an
268	   Issuer in the Issuer-Holder-Verifier model [SD-JWT.VC].

270	1.2.  Rationale

272	   Revocation mechanisms are an essential part of most identity
273	   ecosystems.  In the past, revocation of X.509 TLS certificates has
274	   been proven difficult.  Traditional certificate revocation lists
275	   (CRLs) have limited scalability; Online Certificate Status Protocol
276	   (OCSP) has additional privacy risks, since the client is leaking the
277	   requested website to a third party.  OCSP stapling is addressing some
278	   of these problems at the cost of less up-to-date data.  Modern
279	   approaches use accumulator-based revocation registries and Zero-
280	   Knowledge-Proofs to accommodate for this privacy gap, but face
281	   scalability issues again.  Another alternative is short-lived
282	   Referenced Tokens with regular re-issuance, but this puts additional
283	   burden on the Issuer's infrastructure.

285	   This specification seeks to find a balance between scalability,
286	   security and privacy by representing statuses as individual bits,
287	   packing them into an array, and compressing the resulting binary
288	   data.  Thereby, a Status List may contain statuses of many thousands
289	   or millions Referenced Tokens while remaining as small as possible.
290	   Placing a large number of Referenced Tokens into the same list also
291	   offers Holders and Relying Parties herd privacy from the Status
292	   Provider.

294	1.3.  Design Considerations

296	   The decisions taken in this specification aim to achieve the
297	   following design goals:

299	   *  the specification shall favor a simple and easy-to-understand
300	      concept

302	   *  the specification shall be easy, fast and secure to implement in
303	      all major programming languages

305	   *  the specification shall be optimized to support the most common
306	      use cases and avoid unnecessary complexity of corner cases

308	   *  the Status List shall scale up to millions of tokens to support
309	      large-scale government or enterprise use cases

311	   *  the Status List shall enable caching policies and offline support

313	   *  the specification shall support JSON and CBOR based tokens

315	   *  the specification shall not specify key resolution or trust
316	      frameworks

318	   *  the specification shall define an extension point that enables
319	      other mechanisms to convey information about the status of a
320	      Referenced Token

322	1.4.  Prior Work

324	   Representing statuses with bits in an array is a rather old and well-
325	   known concept in computer science and there has been prior work to
326	   use this for revocation and status management such as a paper by
327	   Smith et al. [smith2020let] that proposed a mechanism called
328	   Certificate Revocation Vectors based on xz compressed bit vectors for
329	   each expiration day and the W3C bit Status List [W3C.SL] that
330	   similarly uses a compressed bit representation.

332	1.5.  Status Mechanisms Registry

334	   This specification establishes IANA "Status Mechanisms" registries
335	   for status mechanisms for JOSE-based tokens and for status mechanisms
336	   for COSE-based tokens and registers the members defined by this
337	   specification.  Other specifications can register other members used
338	   for status retrieval.

340	   Other status mechanisms may have different tradeoffs regarding
341	   security, privacy, scalability and complexity.  The privacy and
342	   security considerations in this document only represent the
343	   properties of the Status List mechanism.

345	2.  Conventions and Definitions

347	   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
348	   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
349	   "OPTIONAL" in this document are to be interpreted as described in
350	   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
351	   capitals, as shown here.

353	3.  Terminology

355	   Issuer:  An entity that issues the Referenced Token.  Also known as a
356	      Provider.

358	   Status Issuer:  An entity that issues the Status List Token about the
359	      status information of the Referenced Token.  This role may be
360	      fulfilled by the Issuer.

362	   Status Provider:  An entity that provides the Status List Token on a
363	      public endpoint.  This role may be fulfilled by the Status Issuer.

365	   Holder:  An entity that receives Referenced Tokens from the Issuer
366	      and presents them to Relying Parties.

368	   Relying Party:  An entity that relies on the Referenced Token and
369	      fetches the corresponding Status List Token to validate the status
370	      of that Referenced Token.  Also known as a Verifier.

372	   Status List:  An object in JSON or CBOR representation containing a
373	      compressed byte array that represents the statuses of many
374	      Referenced Tokens.

376	   Status List Token:  A token in JWT (as defined in [RFC7519]) or CWT
377	      (as defined in [RFC8392]) representation that contains a
378	      cryptographically secured Status List.

380	   Referenced Token:  A cryptographically secured data structure that
381	      contains a "status" claim that references a mechanism to retrieve
382	      status information about this Referenced Token.  This document
383	      defines the Status List mechanism in which case the Referenced
384	      Token contains a reference to an entry in a Status List Token.  It
385	      is RECOMMENDED to use JSON [RFC8259] with JOSE as defined in
386	      [RFC7515] or CBOR [RFC8949] with COSE as defined in [RFC9052].
387	      Examples for Referenced Tokens are SD-JWT VC and ISO mdoc.

389	   Client:  An application that fetches information, such as a Status
390	      List Token, from the Status List Provider on behalf of the Holder
391	      or Relying Party.

393	   base64url:  Denotes the URL-safe base64 encoding with all trailing
394	      '=' characters omitted as defined in Section 2 of [RFC7515] as
395	      "Base64url Encoding".

397	4.  Status List

399	   A Status List is a data structure that contains the statuses of many
400	   Referenced Tokens represented by one or multiple bits.  Section 4.1
401	   describes how to construct a compressed byte array that is the base
402	   component for the Status List data structure.  The second and third
403	   sections describe how to encode such a Status List in JSON and CBOR
404	   representations.

406	4.1.  Compressed Byte Array

408	   A compressed byte array containing the status information of the
409	   Referenced Token is composed by the following algorithm:

411	   1.  The Status Issuer MUST define a number of bits (bits) of either
412	       1,2,4 or 8, that represents the amount of bits used to describe
413	       the status of each Referenced Token within this Status List.
414	       Therefore, up to 2,4,16 or 256 statuses for a Referenced Token
415	       are possible, depending on the bit size.  This limitation is
416	       intended to limit bit manipulation necessary to a single byte for
417	       every operation and thus keeping implementations simpler and less
418	       error-prone.

420	   2.  The Status Issuer creates a byte array of size = amount of
421	       Referenced Tokens * bits / 8 or greater.  Depending on the bits,
422	       each byte in the array corresponds to 8/(bits) statuses (8,4,2 or
423	       1).

425	   3.  The Status Issuer sets the status values for all Referenced
426	       Tokens within the byte array.  Each Referenced Token is assigned
427	       a distinct index from 0 to one less than the number of Referenced
428	       Tokens assigned to the Status List.  Each index identifies a
429	       contiguous block of bits in the byte array, with the blocks being
430	       packed into bytes from the least significant bit ("0") to the
431	       most significant bit ("7").  These bits contain the encoded
432	       status value of the Referenced Token (see Section 7 for more
433	       details on the values).

435	   4.  The Status Issuer compresses the byte array using DEFLATE
436	       [RFC1951] with the ZLIB [RFC1950] data format.  Implementations
437	       are RECOMMENDED to use the highest compression level available.

439	   The following example illustrates the byte array of a Status List
440	   that represents the statuses of 16 Referenced Tokens with a bits of
441	   1, requiring 2 bytes (16 bits) for the uncompressed byte array:

443	   status[0] = 0b1
444	   status[1] = 0b0
445	   status[2] = 0b0
446	   status[3] = 0b1
447	   status[4] = 0b1
448	   status[5] = 0b1
449	   status[6] = 0b0
450	   status[7] = 0b1
451	   status[8] = 0b1
452	   status[9] = 0b1
453	   status[10] = 0b0
454	   status[11] = 0b0
455	   status[12] = 0b0
456	   status[13] = 0b1
457	   status[14] = 0b0
458	   status[15] = 0b1
459	   These bits are concatenated:

461	   byte no            0                  1
462	   bit no      7 6 5 4 3 2 1 0    7 6 5 4 3 2 1 0
463	              +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+
464	   values     |1|0|1|1|1|0|0|1|  |1|0|1|0|0|0|1|1|
465	              +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+
466	   index       7 6 5 4 3 2 1 0   15   ...  10 9 8
467	              \_______________/  \_______________/
468	   byte value       0xB9               0xA3

470	   In the following example, the Status List additionally includes the
471	   Status Type "SUSPENDED".  As the Status Type value for "SUSPENDED" is
472	   0x02 and does not fit into 1 bit, the bits is required to be 2.  This
473	   example illustrates the byte array of a Status List that represents
474	   the statuses of 12 Referenced Tokens with a bits of 2, requiring 3
475	   bytes (24 bits) for the uncompressed byte array:

477	   status[0] = 0b01
478	   status[1] = 0b10
479	   status[2] = 0b00
480	   status[3] = 0b11
481	   status[4] = 0b0
482	   status[5] = 0b01
483	   status[6] = 0b00
484	   status[7] = 0b01
485	   status[8] = 0b01
486	   status[9] = 0b10
487	   status[10] = 0b11
488	   status[11] = 0b11

490	   These bits are concatenated:

492	   byte no            0                  1                  2
493	   bit no      7 6 5 4 3 2 1 0    7 6 5 4 3 2 1 0    7 6 5 4 3 2 1 0
494	              +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+
495	   values     |1|1|0|0|1|0|0|1|  |0|1|0|0|0|1|0|0|  |1|1|1|1|1|0|0|1|
496	              +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+  +-+-+-+-+-+-+-+-+
497	               \ / \ / \ / \ /    \ / \ / \ / \ /    \ / \ / \ / \ /
498	   status      11  00  10  01     01  00  01  00     11  11  10  01
499	   index        3   2   1   0      7   6   5   4      11  10  9   8
500	                \___________/      \___________/      \___________/
501	   byte value       0xC9               0x44               0xF9

503	4.2.  Status List in JSON Format

505	   This section defines the data structure for a JSON-encoded Status
506	   List:

508	   *  The StatusList structure is a JSON Object that contains the
509	      following members:

511	      -  bits: REQUIRED.  JSON Integer specifying the number of bits per
512	         Referenced Token in the compressed byte array (lst).  The
513	         allowed values for bits are 1, 2, 4, and 8.

515	      -  lst: REQUIRED.  JSON String that contains the status values for
516	         all the Referenced Tokens it conveys statuses for.  The value
517	         MUST be the base64url-encoded compressed byte array as
518	         specified in Section 4.1.

520	      -  aggregation_uri: OPTIONAL.  JSON String that contains a URI to
521	         retrieve the Status List Aggregation for this type of
522	         Referenced Token or Issuer.  See Section 9 for further details.

524	   The following example illustrates the JSON representation of the
525	   Status List with bits=1 from the examples above:

527	   byte_array = [0xb9, 0xa3]
528	   encoded:
529	   {
530	     "bits": 1,
531	     "lst": "eNrbuRgAAhcBXQ"
532	   }

534	   The following example illustrates the JSON representation of the
535	   Status List with bits=2 from the examples above:

537	   byte_array = [0xc9, 0x44, 0xf9]
538	   encoded:
539	   {
540	     "bits": 2,
541	     "lst": "eNo76fITAAPfAgc"
542	   }

544	   See Appendix C for more test vectors.

546	4.3.  Status List in CBOR Format

548	   This section defines the data structure for a CBOR-encoded Status
549	   List:

551	   *  The StatusList structure is a CBOR map (major type 5) and defines
552	      the following entries:

554	      -  bits: REQUIRED.  CBOR Unsigned integer (major type 0) that
555	         contains the number of bits per Referenced Token in the
556	         compressed byte array (lst).  The allowed values for bits are
557	         1, 2, 4, and 8.

559	      -  lst: REQUIRED.  CBOR Byte string (major type 2) that contains
560	         the status values for all the Referenced Tokens it conveys
561	         statuses for.  The value MUST be the compressed byte array as
562	         specified in Section 4.1.

564	      -  aggregation_uri: OPTIONAL.  CBOR Text string (major type 3)
565	         that contains a URI to retrieve the Status List Aggregation for
566	         this type of Referenced Token.  See Section 9 for further
567	         detail.

569	   The following is the CDDL [RFC8610] definition of the StatusList
570	   structure:

572	   StatusList = {
573	       bits: 1 / 2 / 4 / 8, ; The number of bits used per Referenced Token
574	       lst: bstr, ; Byte string that contains the Status List
575	       ? aggregation_uri: tstr ; link to the Status List Aggregation
576	   }

578	   The following example illustrates the CBOR representation of the
579	   Status List in Hex:

581	   byte_array = [0xb9, 0xa3]
582	   encoded:
583	   a2646269747301636c73744a78dadbb918000217015d

585	   The following is the CBOR Annotated Hex output of the example above:

587	   a2                              # map(2)
588	     64                            #   string(4)
589	       62697473                    #     "bits"
590	     01                            #   uint(1)
591	     63                            #   string(3)
592	       6c7374                      #     "lst"
593	     4a                            #   bytes(10)
594	       78dadbb918000217015d        #     "xÚÛ¹\x18\x00\x02\x17\x01]"

596	   See Appendix C for more test vectors.

598	5.  Status List Token

600	   A Status List Token embeds a Status List into a token that is
601	   cryptographically signed and protects the integrity of the Status
602	   List.  This allows for the Status List Token to be hosted by third
603	   parties or be transferred for offline use cases.

605	   This section specifies Status List Tokens in JSON Web Token (JWT) and
606	   CBOR Web Token (CWT) format.

608	5.1.  Status List Token in JWT Format

610	   The Status List Token MUST be encoded as a "JSON Web Token (JWT)"
611	   according to [RFC7519].

613	   The following content applies to the JWT Header:

615	   *  typ: REQUIRED.  The JWT type MUST be statuslist+jwt.

617	   The following content applies to the JWT Claims Set:

619	   *  sub: REQUIRED.  As generally defined in [RFC7519].  The sub
620	      (subject) claim MUST specify the URI of the Status List Token.
621	      The value MUST be equal to that of the uri claim contained in the
622	      status_list claim of the Referenced Token.

624	   *  iat: REQUIRED.  As generally defined in [RFC7519].  The iat
625	      (issued at) claim MUST specify the time at which the Status List
626	      Token was issued.

628	   *  exp: RECOMMENDED.  As generally defined in [RFC7519].  The exp
629	      (expiration time) claim, if present, MUST specify the time at
630	      which the Status List Token is considered expired by the Status
631	      Issuer.  Consider the guidance provided in Section 13.7.

633	   *  ttl: RECOMMENDED.  The ttl (time to live) claim, if present, MUST
634	      specify the maximum amount of time, in seconds, that the Status
635	      List Token can be cached by a consumer before a fresh copy SHOULD
636	      be retrieved.  The value of the claim MUST be a positive number
637	      encoded in JSON as a number.  Consider the guidance provided in
638	      Section 13.7.

640	   *  status_list: REQUIRED.  The status_list (status list) claim MUST
641	      specify the Status List conforming to the structure defined in
642	      Section 4.2.

644	   The following additional rules apply:

646	   1.  The JWT MAY contain other claims.

648	   2.  The JWT MUST be secured using a cryptographic signature or MAC
649	       algorithm.  Relying Parties MUST reject JWTs with an invalid
650	       signature.

652	   3.  Relying Parties MUST reject JWTs that are not valid in all other
653	       respects per "JSON Web Token (JWT)" [RFC7519].

655	   4.  Application of additional restrictions and policies are at the
656	       discretion of the Relying Party.

658	   The following is a non-normative example of a Status List Token in
659	   JWT format:

661	   {
662	     "alg": "ES256",
663	     "kid": "12",
664	     "typ": "statuslist+jwt"
665	   }
666	   .
667	   {
668	     "exp": 2291720170,
669	     "iat": 1686920170,
670	     "status_list": {
671	       "bits": 1,
672	       "lst": "eNrbuRgAAhcBXQ"
673	     },
674	     "sub": "https://example.com/statuslists/1",
675	     "ttl": 43200
676	   }

678	5.2.  Status List Token in CWT Format

680	   The Status List Token MUST be encoded as a "CBOR Web Token (CWT)"
681	   according to [RFC8392].  The Status List Token MUST NOT be tagged
682	   with the CWT tag defined in Section 6 of [RFC8392].  The COSE message
683	   MUST either be the tagged COSE_Sign1_Tagged (18) or COSE_Mac0_Tagged
684	   (17) as defined in Section 2 of [RFC9052].

686	   The following content applies to the protected header of the CWT:

688	   *  16 (type): REQUIRED.  The type of the CWT MUST be application/
689	      statuslist+cwt or the registered CoAP Content-Format ID (see
690	      Section 14.8) as defined in [RFC9596].

692	   The following content applies to the CWT Claims Set:

694	   *  2 (subject): REQUIRED.  As generally defined in [RFC8392].  The
695	      subject claim MUST specify the URI of the Status List Token.  The
696	      value MUST be equal to that of the uri claim contained in the
697	      status_list claim of the Referenced Token.

699	   *  6 (issued at): REQUIRED.  As generally defined in [RFC8392].  The
700	      issued at claim MUST specify the time at which the Status List
701	      Token was issued.

703	   *  4 (expiration time): RECOMMENDED.  As generally defined in
704	      [RFC8392].  The expiration time claim, if present, MUST specify
705	      the time at which the Status List Token is considered expired by
706	      its issuer.  Consider the guidance provided in Section 13.7.

708	   *  65534 (time to live): RECOMMENDED.  Unsigned integer (major type
709	      0).  The time to live claim, if present, MUST specify the maximum
710	      amount of time, in seconds, that the Status List Token can be
711	      cached by a consumer before a fresh copy SHOULD be retrieved.  The
712	      value of the claim MUST be a positive number.  Consider the
713	      guidance provided in Section 13.7.

715	   *  65533 (status list): REQUIRED.  The status list claim MUST specify
716	      the Status List conforming to the structure defined in
717	      Section 4.3.

719	   The following additional rules apply:

721	   1.  The CWT MAY contain other claims.

723	   2.  The CWT MUST be secured using a cryptographic signature or MAC
724	       algorithm.  Relying Parties MUST reject CWTs with an invalid
725	       signature.

727	   3.  Relying Parties MUST reject CWTs that are not valid in all other
728	       respects per "CBOR Web Token (CWT)" [RFC8392].

730	   4.  Application of additional restrictions and policies are at the
731	       discretion of the Relying Party.

733	   The following is a non-normative example of a Status List Token in
734	   CWT format in Hex:

736	   d2845820a2012610781a6170706c69636174696f6e2f7374617475736c6973742b63
737	   7774a1044231325850a502782168747470733a2f2f6578616d706c652e636f6d2f73
738	   74617475736c697374732f31061a648c5bea041a8898dfea19fffe19a8c019fffda2
739	   646269747301636c73744a78dadbb918000217015d584093fa4d01032b18c35e2fe1
740	   101b77fd6cc9440022caa4694450c4e4e9feab4e99d1fa6d9772ce2bf3a12e0323de
741	   d7c982c5e101a5e67f0cbc1e2b6f57ce99c279
742	   The following is the CBOR Annotated Hex output of the example above:

744	d2                              # tag(18)
745	  84                            #   array(4)
746	    58 20                       #     bytes(32)
747	      a2012610781a6170706c6963  #       "¢\x01&\x10x\x1aapplic"
748	      6174696f6e2f737461747573  #       "ation/status"
749	      6c6973742b637774          #       "list+cwt"
750	    a1                          #     map(1)
751	      04                        #       uint(4)
752	      42                        #       bytes(2)
753	        3132                    #         "12"
754	    58 50                       #     bytes(80)
755	      a502782168747470733a2f2f  #       "¥\x02x!https://"
756	      6578616d706c652e636f6d2f  #       "example.com/"
757	      7374617475736c697374732f  #       "statuslists/"
758	      31061a648c5bea041a8898df  #       "1\x06\x1ad\x8c[ê\x04\x1a\x88\x98ß"
759	      ea19fffe19a8c019fffda264  #       "ê\x19ÿþ\x19¨À\x19ÿý¢d"
760	      6269747301636c73744a78da  #       "bits\x01clstJxÚ"
761	      dbb918000217015d          #       "Û¹\x18\x00\x02\x17\x01]"
762	    58 40                       #     bytes(64)
763	      93fa4d01032b18c35e2fe110  #       "\x93úM\x01\x03+\x18Ã^/á\x10"
764	      1b77fd6cc9440022caa46944  #       "\x1bwýlÉD\x00"Ê¤iD"
765	      50c4e4e9feab4e99d1fa6d97  #       "PÄäéþ«N\x99Ñúm\x97"
766	      72ce2bf3a12e0323ded7c982  #       "rÎ+ó¡.\x03#Þ×É\x82"
767	      c5e101a5e67f0cbc1e2b6f57  #       "Åá\x01¥æ\x7f\x0c¼\x1e+oW"
768	      ce99c279                  #       "Î\x99Ây"

770	6.  Referenced Token

772	6.1.  Status Claim

774	   By including a "status" claim in a Referenced Token, the Issuer is
775	   referencing a mechanism to retrieve status information about this
776	   Referenced Token.  This specification defines one possible member of
777	   the "status" object, called "status_list".  Other members of the
778	   "status" object may be defined by other specifications.  This is
779	   analogous to "cnf" claim in Section 3.1 of [RFC7800] in which
780	   different authenticity confirmation methods can be included.

782	6.2.  Referenced Token in JOSE

784	   The Referenced Token MAY be encoded as a "JSON Web Token (JWT)"
785	   according to [RFC7519] or other formats based on JOSE.

787	   The following content applies to the JWT Claims Set:

789	   *  status: REQUIRED.  The status (status) claim MUST specify a JSON
790	      Object that contains at least one reference to a status mechanism.

792	      -  status_list: REQUIRED when the status mechanism defined in this
793	         specification is used.  It MUST specify a JSON Object that
794	         contains a reference to a Status List Token.  It MUST at least
795	         contain the following claims:

797	         o  idx: REQUIRED.  The idx (index) claim MUST specify a non-
798	            negative Integer that represents the index to check for
799	            status information in the Status List for the current
800	            Referenced Token.

802	         o  uri: REQUIRED.  The uri (URI) claim MUST specify a String
803	            value that identifies the Status List Token containing the
804	            status information for the Referenced Token.  The value of
805	            uri MUST be a URI conforming to [RFC3986].

807	   Application of additional restrictions and policies are at the
808	   discretion of the Relying Party.

810	   The following is a non-normative example of a decoded header and
811	   payload of a Referenced Token:

813	   {
814	     "alg": "ES256",
815	     "kid": "11"
816	   }
817	   .
818	   {
819	     "status": {
820	       "status_list": {
821	         "idx": 0,
822	         "uri": "https://example.com/statuslists/1"
823	       }
824	     }
825	   }

827	   SD-JWT-based Verifiable Credentials (Section 3.2.2.2 of [SD-JWT.VC])
828	   introduces the usage of the status mechanism defined in this section.
829	   Therefore, an SD-JWT VC can be considered a Referenced Token.  The
830	   following is a non-normative example of a Referenced Token in SD-JWT
831	   VC serialized form as received from an Issuer:

833	   eyJhbGciOiAiRVMyNTYiLCAidHlwIjogImV4YW1wbGUrc2Qtand0In0.eyJfc2QiOiBb
834	   Ikh2cktYNmZQVjB2OUtfeUNWRkJpTEZIc01heGNEXzExNEVtNlZUOHgxbGciXSwgImlz
835	   cyI6ICJodHRwczovL2V4YW1wbGUuY29tL2lzc3VlciIsICJpYXQiOiAxNjgzMDAwMDAw
836	   LCAiZXhwIjogMTg4MzAwMDAwMCwgInN1YiI6ICI2YzVjMGE0OS1iNTg5LTQzMWQtYmFl
837	   Ny0yMTkxMjJhOWVjMmMiLCAic3RhdHVzIjogeyJzdGF0dXNfbGlzdCI6IHsiaWR4Ijog
838	   MCwgInVyaSI6ICJodHRwczovL2V4YW1wbGUuY29tL3N0YXR1c2xpc3RzLzEifX0sICJf
839	   c2RfYWxnIjogInNoYS0yNTYifQ.-kgS-R-Z4DEDlqb8kb6381_gHHNatsoF1fcVKZk3M
840	   06CrnV8F8k9d2w2V_YAOvgcb0f11FqDFezXBXH30d4vcw~WyIyR0xDNDJzS1F2ZUNmR2
841	   ZyeU5STjl3IiwgInN0cmVldF9hZGRyZXNzIiwgIlNjaHVsc3RyLiAxMiJd~WyJlbHVWN
842	   U9nM2dTTklJOEVZbnN4QV9BIiwgImxvY2FsaXR5IiwgIlNjaHVscGZvcnRhIl0~WyI2S
843	   Wo3dE0tYTVpVlBHYm9TNXRtdlZBIiwgInJlZ2lvbiIsICJTYWNoc2VuLUFuaGFsdCJd~
844	   WyJlSThaV205UW5LUHBOUGVOZW5IZGhRIiwgImNvdW50cnkiLCAiREUiXQ~WyJRZ19PN
845	   jR6cUF4ZTQxMmExMDhpcm9BIiwgImFkZHJlc3MiLCB7Il9zZCI6IFsiNnZoOWJxLXpTN
846	   EdLTV83R3BnZ1ZiWXp6dTZvT0dYcm1OVkdQSFA3NVVkMCIsICI5Z2pWdVh0ZEZST0NnU
847	   nJ0TmNHVVhtRjY1cmRlemlfNkVyX2o3NmttWXlNIiwgIktVUkRQaDRaQzE5LTN0aXotR
848	   GYzOVY4ZWlkeTFvVjNhM0gxRGEyTjBnODgiLCAiV045cjlkQ0JKOEhUQ3NTMmpLQVN4V
849	   GpFeVc1bTV4NjVfWl8ycm8yamZYTSJdfV0~

851	   The resulting payload of the example above:

853	   {
854	     "_sd": [
855	       "HvrKX6fPV0v9K_yCVFBiLFHsMaxcD_114Em6VT8x1lg"
856	     ],
857	     "iss": "https://example.com/issuer",
858	     "iat": 1683000000,
859	     "exp": 1883000000,
860	     "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
861	     "status": {
862	       "status_list": {
863	         "idx": 0,
864	         "uri": "https://example.com/statuslists/1"
865	       }
866	     },
867	     "_sd_alg": "sha-256"
868	   }

870	6.3.  Referenced Token in COSE

872	   The Referenced Token MAY be encoded as a "CBOR Web Token (CWT)"
873	   object according to [RFC8392] or other formats based on COSE.
874	   Referenced Tokens in CBOR should share the same core data structure
875	   for a status list reference:

877	   *  The Status CBOR structure is a Map that MUST include at least one
878	      data item that refers to a status mechanism.  Each data item in
879	      the Status CBOR structure comprises a key-value pair, where the
880	      key must be a CBOR text string (major type 3) specifying the
881	      identifier of the status mechanism and the corresponding value
882	      defines its contents.

884	      -  status_list (status list): REQUIRED when the status mechanism
885	         defined in this specification is used.  It has the same
886	         definition as the status_list claim in Section 6.2 but MUST be
887	         encoded as a StatusListInfo CBOR structure with the following
888	         fields:

890	         o  idx: REQUIRED.  Unsigned integer (major type 0) The idx
891	            (index) claim MUST specify a non-negative Integer that
892	            represents the index to check for status information in the
893	            Status List for the current Referenced Token.

895	         o  uri: REQUIRED.  Text string (major type 3).  The uri (URI)
896	            claim MUST specify a String value that identifies the Status
897	            List Token containing the status information for the
898	            Referenced Token.  The value of uri MUST be a URI conforming
899	            to [RFC3986].

901	6.3.1.  CBOR Web Token (CWT)

903	   The following content applies to the CWT Claims Set:

905	   *  65535 (status): REQUIRED.  The status claim contains the Status
906	      CBOR structure as described in Section 6.3.

908	   Application of additional restrictions and policies are at the
909	   discretion of the Relying Party.

911	   The following is a non-normative example of a Referenced Token in CWT
912	   format in Hex:

914	   d28443a10126a1044231325866a502653132333435017368747470733a2f2f657861
915	   6d706c652e636f6d061a648c5bea041a8898dfea19ffffa16b7374617475735f6c69
916	   7374a2636964780063757269782168747470733a2f2f6578616d706c652e636f6d2f
917	   7374617475736c697374732f315840340f7efea10f1a36dc4797636a17b4dd4848b6
918	   8997d1d10e8cceb3a38ff33b3dda72964a83989f6cf98560c2fc97a08bc8977cc6b0
919	   f84cfedab93d3e4481e938

921	   The following is the CBOR Annotated Hex output of the example above:

923	d2                              # tag(18)
924	  84                            #   array(4)
925	    43                          #     bytes(3)
926	      a10126                    #       "¡\x01&"
927	    a1                          #     map(1)
928	      04                        #       uint(4)
929	      42                        #       bytes(2)
930	        3132                    #         "12"
931	    58 66                       #     bytes(102)
932	      a50265313233343501736874  #       "¥\x02e12345\x01sht"
933	      7470733a2f2f6578616d706c  #       "tps://exampl"
934	      652e636f6d061a648c5bea04  #       "e.com\x06\x1ad\x8c[ê\x04"
935	      1a8898dfea19ffffa16b7374  #       "\x1a\x88\x98ßê\x19ÿÿ¡kst"
936	      617475735f6c697374a26369  #       "atus_list¢ci"
937	      647800637572697821687474  #       "dx\x00curix!htt"
938	      70733a2f2f6578616d706c65  #       "ps://example"
939	      2e636f6d2f7374617475736c  #       ".com/statusl"
940	      697374732f31              #       "ists/1"
941	    58 40                       #     bytes(64)
942	      340f7efea10f1a36dc479763  #       "4\x0f~þ¡\x0f\x1a6ÜG\x97c"
943	      6a17b4dd4848b68997d1d10e  #       "j\x17´ÝHH¶\x89\x97ÑÑ\x0e"
944	      8cceb3a38ff33b3dda72964a  #       "\x8cÎ³£\x8fó;=Úr\x96J"
945	      83989f6cf98560c2fc97a08b  #       "\x83\x98\x9flù\x85`Âü\x97\xa0\x8b"
946	      c8977cc6b0f84cfedab93d3e  #       "È\x97|Æ°øLþÚ¹=>"
947	      4481e938                  #       "D\x81é8"

949	6.3.2.  ISO mdoc

951	   ISO mdoc [ISO.mdoc] may utilize the Status List mechanism by
952	   introducing the status parameter in the Mobile Security Object (MSO)
953	   as specified in Section 9.1.2 of [ISO.mdoc].  The status parameter
954	   contains the Status CBOR structure as described in Section 6.3.

956	   It is RECOMMENDED to use status for the label of the field that
957	   contains the Status CBOR structure.

959	   Application of additional restrictions and policies are at the
960	   discretion of the Relying Party.

962	   The following is a non-normative example of an IssuerAuth as
963	   specified in ISO mDL (also referred to as signed MSO) in Hex:

965	   8443a10126a118215901f3308201ef30820195a00302010202140bfec7da97e048e
966	   15ac3dacb9eafe82e64fd07f5300a06082a8648ce3d040302302331143012060355
967	   04030c0b75746f7069612069616361310b3009060355040613025553301e170d323
968	   4313030313030303030305a170d3235313030313030303030305a30213112301006
969	   035504030c0975746f706961206473310b300906035504061302555330593013060
970	   72a8648ce3d020106082a8648ce3d03010703420004ace7ab7340e5d9648c5a72a9
971	   a6f56745c7aad436a03a43efea77b5fa7b88f0197d57d8983e1b37d3a539f4d5883
972	   65e38cbbf5b94d68c547b5bc8731dcd2f146ba381a83081a5301c0603551d1f0415
973	   30133011a00fa00d820b6578616d706c652e636f6d301e0603551d1204173015811
974	   36578616d706c65406578616d706c652e636f6d301d0603551d0e0416041414e290
975	   17a6c35621ffc7a686b7b72db06cd12351301f0603551d2304183016801454fa238
976	   3a04c28e0d930792261c80c4881d2c00b300e0603551d0f0101ff04040302078030
977	   150603551d250101ff040b3009060728818c5d050102300a06082a8648ce3d04030
978	   20348003045022100b7103fd4b90529f50bd6f70c5ae5ce7f4f3d4d15a4e082812f
979	   9fa1f5c2e5aa0a0220070b2822ec7ce6c56804923a85b2cfbffd054cf9a915f070c
980	   fef7179a4bc6569590320d81859031ba766737461747573a16b7374617475735f6c
981	   697374a26369647819019c63757269782168747470733a2f2f6578616d706c652e6
982	   36f6d2f7374617475736c697374732f3167646f6354797065756f72672e69736f2e
983	   31383031332e352e312e6d444c6776657273696f6e63312e306c76616c696469747
984	   9496e666fa3667369676e6564c074323032342d31302d30315431333a33303a3032
985	   5a6976616c696446726f6dc074323032342d31302d30315431333a33303a30325a6
986	   a76616c6964556e74696cc074323032352d31302d30315431333a33303a30325a6c
987	   76616c756544696765737473a1716f72672e69736f2e31383031332e352e31ac005
988	   820a81d65ed5075fbd7ee19fa66e2bb3047ed826e2769873e7ef07c923da7a6f243
989	   01582048701a9546492284d266ed81d439230a582d0e1f17a08ab1859a3efe98069
990	   0a4025820d11fe48c8835b30bfb3895c3905436ddfb63f59ab9eee181b110985329
991	   2a8f62035820a741bf05e20a8bc359e32426106ed0899b2c60262cc3acc637ddc99
992	   41095fb7a045820ab67cb9a8f20a8572f77f02727367d08dc8e57fb89deb46b9c62
993	   6e94457b7d8b055820bacddb4142b3842bd555206eb5acb27ded063294995c7e7fe
994	   fbf93ece522604d065820bfd02b3aebdc05b53b5539226c38088d6d784b0ea0fab6
995	   9eb9311650a48d325307582027dab70fe71da63e5e5d199e8ae5b79cbe8904bc30c
996	   5b7544fb809e02ccb3e6a0858200dbd7ccc9c7727d3d17295f1b6f1914071670ee2
997	   3d4d33530c31f1f406b8e3b7095820a5beb5efadf37f21637209abc519830681cc5
998	   1f334818a823fec13b29552f5ba0a5820d8047c95f9272d7d07b2c13a9f5ac2ee02
999	   380ab272a165e569391d89a2152c3c0b582004939930ffb4911ef03487a153605a3
1000	   0368b69f2437d6d21b4c90f92bc144c3e6d6465766963654b6579496e666fa16964
1001	   65766963654b6579a40102200121582096313d6c63e24e3372742bfdb1a33ba2c89
1002	   7dcd68ab8c753e4fbd48dca6b7f9a2258201fb3269edd418857de1b39a4e4a44b92
1003	   fa484caa722c228288f01d0c03a2c3d66f646967657374416c676f726974686d675
1004	   348412d3235365840b7c2d4abe85aa5ba814ef95de0385c71c802be8ac33a4a971a
1005	   85ed800ba7acb59cb21035f4a68fc0caa450cbefd3b255aec72f83595f0ae7b7d50
1006	   fe8a1c4cafe

1008	   The following is the CBOR Diagnostic Notation of the example above:

1010	   [
1011	     << {
1012	       1: -7
1013	     } >>,
1014	     {
1015	       33: h'308201ef30820195a00302010202140bfec7da97e048e15ac3dacb9ea
1016	       fe82e64fd07f5300a06082a8648ce3d04030230233114301206035504030c0b
1017	       75746f7069612069616361310b3009060355040613025553301e170d3234313
1018	       030313030303030305a170d3235313030313030303030305a30213112301006
1019	       035504030c0975746f706961206473310b30090603550406130255533059301
1020	       306072a8648ce3d020106082a8648ce3d03010703420004ace7ab7340e5d964
1021	       8c5a72a9a6f56745c7aad436a03a43efea77b5fa7b88f0197d57d8983e1b37d
1022	       3a539f4d588365e38cbbf5b94d68c547b5bc8731dcd2f146ba381a83081a530
1023	       1c0603551d1f041530133011a00fa00d820b6578616d706c652e636f6d301e0
1024	       603551d120417301581136578616d706c65406578616d706c652e636f6d301d
1025	       0603551d0e0416041414e29017a6c35621ffc7a686b7b72db06cd12351301f0
1026	       603551d2304183016801454fa2383a04c28e0d930792261c80c4881d2c00b30
1027	       0e0603551d0f0101ff04040302078030150603551d250101ff040b300906072
1028	       8818c5d050102300a06082a8648ce3d0403020348003045022100b7103fd4b9
1029	       0529f50bd6f70c5ae5ce7f4f3d4d15a4e082812f9fa1f5c2e5aa0a0220070b2
1030	       822ec7ce6c56804923a85b2cfbffd054cf9a915f070cfef7179a4bc6569'
1031	     },
1032	     << 24( << {
1033	       "status": {
1034	         "status_list": {
1035	           "idx": 412,
1036	           "uri": "https://example.com/statuslists/1"
1037	         }
1038	       },
1039	       "docType": "org.iso.18013.5.1.mDL",
1040	       "version": "1.0",
1041	       "validityInfo": {
1042	         "signed": 2024-10-01 13:30:02+00:00,
1043	         "validFrom": 2024-10-01 13:30:02+00:00,
1044	         "validUntil": 2025-10-01 13:30:02+00:00
1045	       },
1046	       "valueDigests": {
1047	         "org.iso.18013.5.1": {
1048	           0: h'a81d65ed5075fbd7ee19fa66e2bb3047ed826e2769873e7ef07c92
1049	           3da7a6f243',
1050	           1: h'48701a9546492284d266ed81d439230a582d0e1f17a08ab1859a3e
1051	           fe980690a4',
1052	           2: h'd11fe48c8835b30bfb3895c3905436ddfb63f59ab9eee181b11098
1053	           53292a8f62',
1054	           3: h'a741bf05e20a8bc359e32426106ed0899b2c60262cc3acc637ddc9
1055	           941095fb7a',
1056	           4: h'ab67cb9a8f20a8572f77f02727367d08dc8e57fb89deb46b9c626e
1057	           94457b7d8b',
1058	           5: h'bacddb4142b3842bd555206eb5acb27ded063294995c7e7fefbf93
1059	           ece522604d',
1060	           6: h'bfd02b3aebdc05b53b5539226c38088d6d784b0ea0fab69eb93116
1061	           50a48d3253',
1062	           7: h'27dab70fe71da63e5e5d199e8ae5b79cbe8904bc30c5b7544fb809
1063	           e02ccb3e6a',
1064	           8: h'0dbd7ccc9c7727d3d17295f1b6f1914071670ee23d4d33530c31f1
1065	           f406b8e3b7',
1066	           9: h'a5beb5efadf37f21637209abc519830681cc51f334818a823fec13
1067	           b29552f5ba',
1068	           10: h'd8047c95f9272d7d07b2c13a9f5ac2ee02380ab272a165e569391
1069	           d89a2152c3c',
1070	           11: h'04939930ffb4911ef03487a153605a30368b69f2437d6d21b4c90
1071	           f92bc144c3e'
1072	         }
1073	       },
1074	       "deviceKeyInfo": {
1075	         "deviceKey": {
1076	           1: 2,
1077	           -1: 1,
1078	           -2: h'96313d6c63e24e3372742bfdb1a33ba2c897dcd68ab8c753e4fbd
1079	           48dca6b7f9a',
1080	           -3: h'1fb3269edd418857de1b39a4e4a44b92fa484caa722c228288f01
1081	           d0c03a2c3d6'
1082	         }
1083	       },
1084	       "digestAlgorithm": "SHA-256"
1085	     } >> ) >>,
1086	     h'b7c2d4abe85aa5ba814ef95de0385c71c802be8ac33a4a971a85ed800ba7acb
1087	     59cb21035f4a68fc0caa450cbefd3b255aec72f83595f0ae7b7d50fe8a1c4cafe'
1088	   ]

1090	7.  Status Types

1092	   This document defines the statuses of Referenced Tokens as Status
1093	   Type values.  A status describes the state, mode, condition or stage
1094	   of an entity that is represented by the Referenced Token.

1096	   A Status List represents exactly one status per Referenced Token.  If
1097	   the Status List contains more than one bit per token (as defined by
1098	   bits in the Status List), then the whole value of bits MUST describe
1099	   one value.  Status Types MUST have a numeric value between 0 and 255
1100	   for their representation in the Status List.  The issuer of the
1101	   Status List MUST choose an adequate bits value (bit size) to be able
1102	   to describe the required Status Types for its application.

1104	7.1.  Status Types Values

1106	   The processing rules for Referenced Tokens (such as JWT or CWT)
1107	   supersede the Referenced Token's status in a TSL.  In particular, a
1108	   Referenced Token that is evaluated as being expired (e.g. through the
1109	   exp claim) but in a TSL has a status of 0x00 ("VALID"), is considered
1110	   expired.

1112	   This document creates a registry in Section 14.5 that includes the
1113	   most common Status Type values.  Applications SHOULD use registered
1114	   values for statuses if they have the correct semantics.  Additional
1115	   values may be defined for particular use cases.  Status Types
1116	   described by this document comprise:

1118	   *  0x00 - "VALID" - The status of the Referenced Token is valid,
1119	      correct or legal.

1121	   *  0x01 - "INVALID" - The status of the Referenced Token is revoked,
1122	      annulled, taken back, recalled or cancelled.

1124	   *  0x02 - "SUSPENDED" - The status of the Referenced Token is
1125	      temporarily invalid, hanging, debarred from privilege.  This
1126	      status is usually temporary.

1128	   The Status Type value 0x03 and Status Type values in the range 0x0C
1129	   until 0x0F are permanently reserved as application specific.  The
1130	   processing of Status Types using these values is application
1131	   specific.  All other Status Type values are reserved for future
1132	   registration.

1134	   See Section 12.8 for privacy considerations on status types.

1136	8.  Verification and Processing

1138	   The fetching, processing and verifying of a Status List Token may be
1139	   done by either the Holder or the Relying Party.  The following
1140	   section is described from the role of the Relying Party, however the
1141	   same rules apply to the Holder.

1143	8.1.  Status List Request

1145	   The Status Provider SHOULD provide Status List Token on an endpoint
1146	   serving an HTTP GET request to the URI provided in the Referenced
1147	   Token, unless the Relying Party and the Status Provider have
1148	   alternative methods of distribution.

1150	   The HTTP endpoint SHOULD support the use of Cross-Origin Resource
1151	   Sharing (CORS) [CORS] and/or other methods as appropriate to enable
1152	   Browser-based clients to access it, unless ecosystems using this
1153	   specification choose not to support Browser-based clients.

1155	   The Relying Party SHOULD send the following Accept HTTP Header to
1156	   indicate the requested response type unless the Content-Type of
1157	   Status List Tokens in the respective ecosystem is known or the
1158	   Relying Party supports both formats:

1160	   *  "application/statuslist+jwt" for Status List Token in JWT format

1162	   *  "application/statuslist+cwt" for Status List Token in CWT format

1164	   If the Relying Party does not send an Accept Header, the response
1165	   type is assumed to be known implicitly or out-of-band.

1167	   The following is a non-normative example of a request for a Status
1168	   List Token with type application/statuslist+jwt:

1170	   GET /statuslists/1 HTTP/1.1
1171	   Host: example.com
1172	   Accept: application/statuslist+jwt

1174	8.2.  Status List Response

1176	   A successful response that contains a Status List Token MUST use an
1177	   HTTP status code in the 2xx range.

1179	   A response MAY also choose to redirect the client to another URI
1180	   using an HTTP status code in the 3xx range, which clients SHOULD
1181	   follow.  See Section 11.4 for security considerations on redirects.

1183	   In the successful response, the Status Provider MUST use the
1184	   following content-type:

1186	   *  "application/statuslist+jwt" for Status List Token in JWT format

1188	   *  "application/statuslist+cwt" for Status List Token in CWT format

1190	   In the case of "application/statuslist+jwt", the response MUST be of
1191	   type JWT and follow the rules of Section 5.1.  In the case of
1192	   "application/statuslist+cwt", the response MUST be of type CWT and
1193	   follow the rules of Section 5.2.

1195	   The body of such an HTTP response contains the raw Status List Token,
1196	   that means the binary encoding as defined in Section 9.2.1 of
1197	   [RFC8392] for a Status List Token in CWT format and the JWS Compact
1198	   Serialization form for a Status List Token in JWT format.  Note that
1199	   while the examples for Status List Tokens in CWT format in this
1200	   document are provided in hex encoding, this is done purely for
1201	   readability; CWT format response bodies are "in binary".

1203	   The HTTP response SHOULD use gzip Content-Encoding as defined in
1204	   [RFC9110] for Status List Tokens in JWT format.

1206	   If caching-related HTTP headers are present in the HTTP response,
1207	   Relying Parties MUST prioritize the exp and ttl claims within the
1208	   Status List Token over the HTTP headers for determining caching
1209	   behavior.

1211	   The following is a non-normative example of a response with a Status
1212	   List Token with type application/statuslist+jwt:

1214	   HTTP/1.1 200 OK
1215	   Content-Type: application/statuslist+jwt

1217	   eyJhbGciOiJFUzI1NiIsImtpZCI6IjEyIiwidHlwIjoic3RhdHVzbGlzdCtqd3QifQ.e
1218	   yJleHAiOjIyOTE3MjAxNzAsImlhdCI6MTY4NjkyMDE3MCwiaXNzIjoiaHR0cHM6Ly9le
1219	   GFtcGxlLmNvbSIsInN0YXR1c19saXN0Ijp7ImJpdHMiOjEsImxzdCI6ImVOcmJ1UmdBQ
1220	   WhjQlhRIn0sInN1YiI6Imh0dHBzOi8vZXhhbXBsZS5jb20vc3RhdHVzbGlzdHMvMSIsI
1221	   nR0bCI6NDMyMDB9.2lKUUNG503R9htu4aHAYi7vjmr3sgApbfoDvPrl65N3URUO1EYqq
1222	   Ql45Jfzd-Av4QzlKa3oVALpLwOEUOq-U_g

1224	8.3.  Validation Rules

1226	   Upon receiving a Referenced Token, a Relying Party MUST first perform
1227	   the validation of the Referenced Token - e.g., checking for expected
1228	   attributes, valid signature and expiration time.  The processing
1229	   rules for Referenced Tokens (such as JWT or CWT) MUST precede any
1230	   evaluation of a Referenced Token's status.  For example, if a token
1231	   is evaluated as being expired through the "exp" (Expiration Time) but
1232	   also has a status of 0x00 ("VALID"), the token is considered expired.
1233	   As this is out of scope for this document, this validation is not
1234	   described here, but is expected to be done according to the format of
1235	   the Referenced Token.

1237	   If this validation is not successful, the Referenced Token MUST be
1238	   rejected.  If the validation was successful, the Relying Party MUST
1239	   perform the following validation steps to evaluate the status of the
1240	   Referenced Token:

1242	   1.  Check for the existence of a status claim, check for the
1243	       existence of a status_list claim within the status claim and
1244	       validate that the content of status_list adheres to the rules
1245	       defined in Section 6.2 for JOSE-based Referenced Tokens and
1246	       Section 6.3 for COSE-based Referenced Tokens.  Other formats of
1247	       Referenced Tokens may define other encoding of the URI and index.

1249	   2.  Resolve the Status List Token from the provided URI

1251	   3.  Validate the Status List Token:

1253	       a.  Validate the Status List Token by following the rules defined
1254	           in Section 7.2 of [RFC7519] for JWTs and Section 7.2 of
1255	           [RFC8392] for CWTs.  This step might require the resolution
1256	           of a public key as described in Section 11.3.

1258	       b.  Check for the existence of the required claims as defined in
1259	           Section 5.1 and Section 5.2 depending on the token type

1261	   4.  All existing claims in the Status List Token MUST be checked
1262	       according to the rules in Section 5.1 and Section 5.2

1264	       a.  The subject claim (sub or 2) of the Status List Token MUST be
1265	           equal to the uri claim in the status_list object of the
1266	           Referenced Token

1268	       b.  If the Relying Party has local policies regarding the
1269	           freshness of the Status List Token, it SHOULD check the
1270	           issued at claim (iat or 6)

1272	       c.  If the expiration time is defined (exp or 4), it MUST be
1273	           checked if the Status List Token is expired

1275	       d.  If the Relying Party is using a system for caching the Status
1276	           List Token, it SHOULD check the ttl claim of the Status List
1277	           Token and retrieve a fresh copy if (time status was resolved
1278	           + ttl < current time)

1280	   5.  Decompress the Status List with a decompressor that is compatible
1281	       with DEFLATE [RFC1951] and ZLIB [RFC1950]

1283	   6.  Retrieve the status value of the index specified in the
1284	       Referenced Token as described in Section 4.  If the provided
1285	       index is out of bounds of the Status List, no statement about the
1286	       status of the Referenced Token can be made and the Referenced
1287	       Token SHOULD be rejected.

1289	   7.  Check the status value as described in Section 7
1290	   If any of these checks fails, no statement about the status of the
1291	   Referenced Token can be made and the Referenced Token SHOULD be
1292	   rejected.

1294	8.4.  Historical Resolution

1296	   By default, the status mechanism defined in this specification only
1297	   conveys information about the state of Referenced Tokens at the time
1298	   the Status List Token was issued.  The validity period for this
1299	   information, as defined by the issuer, is explicitly stated by the
1300	   iat (issued at) and exp (expiration time) claims for JWT and their
1301	   corresponding ones for the CWT representation.  If support for
1302	   historical status information is desired, this can be achieved by
1303	   extending with a timestamp the request for the Status List Token as
1304	   defined in Section 8.1.  This feature has additional privacy
1305	   implications as described in Section 12.7.

1307	   To obtain the Status List Token, the Relying Party MUST send an HTTP
1308	   GET request to the URI provided in the Referenced Token with the
1309	   additional query parameter time and its value being a unix timestamp.
1310	   The response for a valid request SHOULD contain a Status List Token
1311	   that was valid for that specified time or an error.

1313	   If the Server does not support the additional query parameter, it
1314	   SHOULD return a status code of 501 (Not Implemented) or if the
1315	   requested time is not supported it SHOULD return a status code of 406
1316	   (Not Acceptable).  A Status List Token might be served via static
1317	   file hosting (e.g., leveraging a Content Delivery Network) that
1318	   ignores query parameters, which would result in the client requesting
1319	   a historical status list but receiving the current status list.
1320	   Thus, the client MUST reject a response unless the requested
1321	   timestamp is within the valid time of the returned token signaled via
1322	   iat (6 for CWT) and exp (4 for CWT).

1324	   The following is a non-normative example of a GET request using the
1325	   time query parameter:

1327	   GET /statuslists/1?time=1686925000 HTTP/1.1
1328	   Host: example.com
1329	   Accept: application/statuslist+jwt

1331	   The following is a non-normative example of a response for the above
1332	   Request:

1334	   HTTP/1.1 200 OK
1335	   Content-Type: application/statuslist+jwt

1337	   eyJhbGciOiJFUzI1NiIsImtpZCI6IjEyIiwidHlwIjoic3RhdHVzbGlzdCtqd3QifQ.e
1338	   yJleHAiOjIyOTE3MjAxNzAsImlhdCI6MTY4NjkyMDE3MCwiaXNzIjoiaHR0cHM6Ly9le
1339	   GFtcGxlLmNvbSIsInN0YXR1c19saXN0Ijp7ImJpdHMiOjEsImxzdCI6ImVOcmJ1UmdBQ
1340	   WhjQlhRIn0sInN1YiI6Imh0dHBzOi8vZXhhbXBsZS5jb20vc3RhdHVzbGlzdHMvMSIsI
1341	   nR0bCI6NDMyMDB9.2lKUUNG503R9htu4aHAYi7vjmr3sgApbfoDvPrl65N3URUO1EYqq
1342	   Ql45Jfzd-Av4QzlKa3oVALpLwOEUOq-U_g

1344	9.  Status List Aggregation

1346	   Status List Aggregation is an optional mechanism offered by the
1347	   Issuer to publish a list of one or more Status List Tokens URIs,
1348	   allowing a Relying Party to fetch Status List Tokens provided by this
1349	   Issuer.  This mechanism is intended to support fetching and caching
1350	   mechanisms and allow offline validation of the status of a Referenced
1351	   Token for a period of time.

1353	   If a Relying Party encounters an error while validating one of the
1354	   Status List Tokens returned from the Status List Aggregation
1355	   endpoint, it SHOULD continue processing the other Status List Tokens.

1357	   There are two options for a Relying Party to retrieve the Status List
1358	   Aggregation.  An Issuer MAY support any of these mechanisms:

1360	   *  Issuer metadata: The Issuer of the Referenced Token publishes an
1361	      URI which links to Status List Aggregation, e.g. in publicly
1362	      available metadata of an issuance protocol

1364	   *  Status List Parameter: The Status Issuer includes an additional
1365	      claim in the Status List Token that contains the Status List
1366	      Aggregation URI.

1368	                                         ┌─────────────────┐
1369	                                         │                 │
1370	                                         │ Issuer Metadata │
1371	                                         │                 │
1372	                                         └───┬─────────────┘
1373	                                             │
1374	     ┌───────────────────┐                   │ link within metadata
1375	    ┌───────────────────┐│  link all         ▼
1376	   ┌───────────────────┐││◄───────┐  ┌─────────────────────────┐
1377	   │                   ││◄────────┤  │                         │
1378	   │ Status List Token │◄┴────────┴──┤ Status List Aggregation │
1379	   │                   │┘            │                         │
1380	   └───────┬───────────┘             └─────────────────────────┘
1381	           │                                 ▲
1382	           │   link by aggregation_uri       │
1383	           └─────────────────────────────────┘

1385	9.1.  Issuer Metadata

1387	   The Issuer MAY link to the Status List Aggregation URI in metadata
1388	   that can be provided by different means like .well-known metadata as
1389	   is used commonly in OAuth and OpenID Connect, or within Issuer
1390	   certificates or trust lists (such as VICAL as defined in Annex C of
1391	   [ISO.mdoc]).  If the Issuer is an OAuth Authorization Server
1392	   according to [RFC6749], it is RECOMMENDED to use the
1393	   status_list_aggregation_endpoint parameter within its metadata
1394	   defined by [RFC8414].  The Issuer MAY limit the Status List Tokens
1395	   listed by a Status List Aggregation to a particular type of
1396	   Referenced Token.

1398	   The concrete implementation details depend on the specific ecosystem
1399	   and are out of scope of this specification.

1401	9.2.  Status List Parameter

1403	   The URI to the Status List Aggregation MAY be provided as the
1404	   optional parameter aggregation_uri in the Status List itself as
1405	   explained in Section 4.3 and Section 4.2 respectively.  A Relying
1406	   Party may use this URI to retrieve an up-to-date list of relevant
1407	   Status Lists.

1409	9.3.  Status List Aggregation Data Structure

1411	   This section defines the structure for a JSON-encoded Status List
1412	   Aggregation:

1414	   *  status_lists: REQUIRED.  JSON array of strings that contains URIs
1415	      linking to Status List Tokens.

1417	   The Status List Aggregation URI provides a list of Status List Token
1418	   URIs.  This aggregation is in JSON and the returned media type MUST
1419	   be application/json.  A Relying Party can iterate through this list
1420	   and fetch all Status List Tokens before encountering the specific URI
1421	   in a Referenced Token.

1423	   The following is a non-normative example for media type application/
1424	   json:

1426	   {
1427	      "status_lists" : [
1428	         "https://example.com/statuslists/1",
1429	         "https://example.com/statuslists/2",
1430	         "https://example.com/statuslists/3"
1431	      ]
1432	   }

1434	10.  X.509 Certificate Extended Key Usage Extension

1436	   [RFC5280] specifies the Extended Key Usage (EKU) X.509 certificate
1437	   extension for use on end entity certificates.  The extension
1438	   indicates one or more purposes for which the certified public key is
1439	   valid.  The EKU extension can be used in conjunction with the Key
1440	   Usage (KU) extension, which indicates the set of basic cryptographic
1441	   operations for which the certified key may be used.  A certificate's
1442	   issuer explicitly delegates Status List Token signing authority by
1443	   issuing an X.509 certificate containing the KeyPurposeId defined
1444	   below in the extended key usage extension.  Other specifications MAY
1445	   choose to re-use this OID for other status mechanisms under the
1446	   condition that they are registered in the "JWT Status Mechanisms" or
1447	   "CWT Status Mechanisms" registries.

1449	   The following OID is defined for usage in the EKU extension:

1451	     id-kp  OBJECT IDENTIFIER  ::=
1452	          { iso(1) identified-organization(3) dod(6) internet(1)
1453	            security(5) mechanisms(5) pkix(7) kp(3) }

1455	     id-kp-oauthStatusSigning OBJECT IDENTIFIER ::= { id-kp TBD }

1457	11.  Security Considerations

1459	   Status List Tokens as defined in Section 5 only exist in
1460	   cryptographically secured containers which allow checking the
1461	   integrity and origin without relying on other factors such as
1462	   transport security or web PKI.

1464	11.1.  Correct decoding and parsing of the encoded Status List

1466	   Implementers should be particularly careful for the correct parsing
1467	   and decoding of the Status List.  Incorrect implementations might
1468	   check the index on the wrong data or miscalculate the bit and byte
1469	   index leading to an erroneous status of the Referenced Token.
1470	   Beware, that bits are indexed (bit order) from least significant bit
1471	   to most significant bit (also called "right to left") while bytes are
1472	   indexed (byte order) in their natural incrementing byte order
1473	   (usually written for display purpose from left to right).  Endianness
1474	   does not apply here because each status value fits within a single
1475	   byte.

1477	   Implementations SHOULD verify correctness using the test vectors
1478	   given by this specification.

1480	11.2.  Security Guidance for JWT and CWT

1482	   A Status List Token in the JWT format SHOULD follow the security
1483	   considerations of [RFC7519] and the best current practices of
1484	   [RFC8725].

1486	   A Status List Token in the CWT format SHOULD follow the security
1487	   considerations of [RFC8392].

1489	11.3.  Key Resolution and Trust Management

1491	   This specification does not mandate specific methods for key
1492	   resolution and trust management, however the following
1493	   recommendations are made for specifications, profiles, or ecosystems
1494	   that are planning to make use of the Status List mechanism:

1496	   If the Issuer of the Referenced Token is the same entity as the
1497	   Status Issuer, then the same key that is embedded into the Referenced
1498	   Token may be used for the Status List Token.  In this case the Status
1499	   List Token may use:

1501	   *  the same x5c value or an x5t, x5t#S256 or kid parameter
1502	      referencing to the same key as used in the Referenced Token for
1503	      JOSE.

1505	   *  the same x5chain value or an x5t or kid parameter referencing to
1506	      the same key as used in the Referenced Token for COSE.

1508	   Alternatively, the Status Issuer may use the same web-based key
1509	   resolution that is used for the Referenced Token.  In this case the
1510	   Status List Token may use:

1512	   *  an x5u, jwks, jwks_uri or kid parameter referencing to a key using
1513	      the same web-based resolution as used in the Referenced Token for
1514	      JOSE.

1516	   *  an x5u or kid parameter referencing to a key using the same web-
1517	      based resolution as used in the Referenced Token for COSE.

1519	   ┌────────┐  host keys  ┌──────────────────────┐
1520	   │ Issuer ├────────┬───►│ .well-known metadata │
1521	   └─┬──────┘        │    └──────────────────────┘
1522	     ▼ update status │
1523	   ┌───────────────┐ │
1524	   │ Status Issuer ├─┘
1525	   └─┬─────────────┘
1526	     ▼ provide Status List
1527	   ┌─────────────────┐
1528	   │ Status Provider │
1529	   └─────────────────┘

1531	   If the Issuer of the Referenced Token is a different entity than the
1532	   Status Issuer, then the keys used for the Status List Token may be
1533	   cryptographically linked, e.g. by a Certificate Authority through an
1534	   x.509 PKI.  The certificate of the Issuer for the Referenced Token
1535	   and the Status Issuer should be issued by the same Certificate
1536	   Authority and the Status Issuer's certificate should utilize extended
1537	   key usage (Section 10).

1539	   ┌───────────────────────┐
1540	   │ Certificate Authority │
1541	   └─┬─────────────────────┘
1542	     │ authorize
1543	     │  ┌────────┐
1544	     ├─►│ Issuer │
1545	     │  └─┬──────┘
1546	     │    ▼ update status
1547	     │  ┌───────────────┐
1548	     └─►│ Status Issuer │
1549	        └─┬─────────────┘
1550	          ▼ provide Status List
1551	        ┌─────────────────┐
1552	        │ Status Provider │
1553	        └─────────────────┘

1555	11.4.  Redirection 3xx

1557	   HTTP clients that follow 3xx (Redirection) class of status codes
1558	   SHOULD be aware of the possible dangers of redirects, such as
1559	   infinite redirection loops, since they can be used for denial of
1560	   service attacks on clients.  A client SHOULD detect and intervene in
1561	   infinite redirections.  Clients SHOULD apply the guidance for
1562	   redirects given in Section 15.4 of [RFC9110].

1564	11.5.  Expiration and Caching

1566	   Expiration and caching information is conveyed via the exp and ttl
1567	   claims as explained in Section 13.7.  Clients SHOULD check that both
1568	   values are within reasonable ranges before requesting new Status List
1569	   Tokens based on these values to prevent accidentally creating
1570	   unreasonable amounts of requests for a specific URL.  Status Issuers
1571	   could accidentally or maliciously use this mechanism to effectively
1572	   DDoS the contained URL of the Status Provider.

1574	   Reasonable values for both claims highly depend on the use-case
1575	   requirements and clients SHOULD be configured with lower/upper bounds
1576	   for these values that fit their respective use-cases.

1578	11.6.  Status List Token Protection

1580	   This specification allows both, digital signatures using asymmetric
1581	   cryptography, and Message Authentication Codes (MAC) to be used to
1582	   protect Status List Tokens.  Implementers SHOULD only use MACs to
1583	   secure the integrity of Status List Tokens if they fully understand
1584	   the risks of MACs when compared to digital signatures and especially
1585	   the requirements of their use-case scenarios.  These use-cases
1586	   typically represent deployments where Status Issuer and Relying Party
1587	   have a trust relationship and the possibility to securely exchange
1588	   keys out of band or are the same entity and no other entity needs to
1589	   verify the Status List Token.  We expect most deployments to use
1590	   digital signatures for the protection of Status List Tokens and
1591	   implementers SHOULD default to digital signatures if they are unsure.

1593	12.  Privacy Considerations

1595	12.1.  Observability of Issuers

1597	   The main privacy consideration for a Status List, especially in the
1598	   context of the Issuer-Holder-Verifier model [SD-JWT.VC], is to
1599	   prevent the Issuer from tracking the usage of the Referenced Token
1600	   when the status is being checked.  If an Issuer offers status
1601	   information by referencing a specific token, this would enable the
1602	   Issuer to create a profile for the issued token by correlating the
1603	   date and identity of Relying Parties, that are requesting the status.

1605	   The Status List approaches these privacy implications by integrating
1606	   the status information of many Referenced Tokens into the same list.
1607	   Therefore, the Issuer does not learn for which Referenced Token the
1608	   Relying Party is requesting the Status List.  The privacy of the
1609	   Holder is protected by the anonymity within the set of Referenced
1610	   Tokens in the Status List, also called herd privacy.  This limits the
1611	   possibilities of tracking by the Issuer.

1613	   The herd privacy is depending on the number of entities within the
1614	   Status List called its size.  A larger size results in better privacy
1615	   but also impacts the performance as more data has to be transferred
1616	   to read the Status List.

1618	   Additionally, the Issuer may analyse data from the HTTP request to
1619	   identify the Relying Party, e.g. through the sender's IP address.

1621	   This behaviour may be mitigated by:

1623	   *  private relay protocols or other mechanisms hiding the original
1624	      sender like [RFC9458].

1626	   *  using trusted Third Party Hosting, see Section 12.6.

1628	12.2.  Issuer Tracking of Referenced Tokens

1630	   An Issuer could maliciously or accidentally bypass the privacy
1631	   benefits of the herd privacy by either:

1633	   *  Generating a unique Status List for every Referenced Token.  By
1634	      these means, the Issuer could maintain a mapping between
1635	      Referenced Tokens and Status Lists and thus track the usage of
1636	      Referenced Tokens by utilizing this mapping for the incoming
1637	      requests.

1639	   *  Encoding a unique URI in each Referenced Token which points to the
1640	      underlying Status List.  This may involve using URI components
1641	      such as query parameters, unique path segments, or fragments to
1642	      make the URI unique.

1644	   This malicious behavior can be detected by Relying Parties that
1645	   request large amounts of Referenced Tokens by comparing the number of
1646	   different Status Lists and their sizes with the volume of Referenced
1647	   Tokens being verified.

1649	12.3.  Observability of Relying Parties

1651	   Once the Relying Party receives the Referenced Token, the Relying
1652	   Party can request the Status List through the provided uri parameter
1653	   and can validate the Referenced Token's status by looking up the
1654	   corresponding index.  However, the Relying Party may persistently
1655	   store the uri and index of the Referenced Token to request the Status
1656	   List again at a later time.  By doing so regularly, the Relying Party
1657	   may create a profile of the Referenced Token's validity status.  This
1658	   behaviour may be intended as a feature, e.g. for an identity proofing
1659	   (e.g. Know-Your-Customer process in finance industry) that requires
1660	   regular validity checks, but might also be abused in cases where this
1661	   is not intended and unknown to the Holder, e.g. profiling the
1662	   suspension of an employee credential.

1664	   This behaviour could be mitigated by:

1666	   *  regular re-issuance of the Referenced Token, see Section 13.2.

1668	12.4.  Observability of Outsiders

1670	   Outside actors may analyse the publicly available Status Lists to get
1671	   information on the internal processes of the Issuer and its related
1672	   business, e.g. number of customers or clients.  This data may allow
1673	   inferences on the total number of issued Referenced Tokens and the
1674	   revocation rate.  Additionally, actors may regularly fetch this data
1675	   or use the historic data functionality to learn how these numbers
1676	   change over time.

1678	   This behaviour could be mitigated by:

1680	   *  disabling the historical data feature Section 8.4

1682	   *  disabling the Status List Aggregation Section 9

1684	   *  choosing non-sequential, pseudo-random or random indices

1686	   *  using decoy entries to obfuscate the real number of Referenced
1687	      Tokens within a Status List

1689	   *  choosing to deploy and utilize multiple Status Lists
1690	      simultaneously

1692	12.5.  Unlinkability

1694	   The tuple of uri and index inside the Referenced Token are unique and
1695	   therefore is traceable data.

1697	12.5.1.  Colluding Relying Parties

1699	   Two or more colluding Relying Parties may link two transactions
1700	   involving the same Referenced Token by comparing the status claims of
1701	   received Referenced Tokens and therefore determine that they have
1702	   interacted with the same Holder.

1704	   To avoid privacy risks of colluding Relying Parties, it is
1705	   RECOMMENDED that Issuers provide the ability to issue batches of one-
1706	   time-use Referenced Tokens, enabling Holders to use in a single
1707	   interaction with a Relying Party before discarding.  See Section 13.2
1708	   to avoid further correlatable information by the values of uri and
1709	   idx, Status Issuers are RECOMMENDED to:

1711	   *  choose non-sequential, pseudo-random or random indices

1713	   *  use decoy entries to obfuscate the real number of Referenced
1714	      Tokens within a Status List

1716	   *  choose to deploy and utilize multiple Status Lists simultaneously

1718	12.5.2.  Colluding Status Issuer and Relying Party

1720	   A Status Issuer and a Relying Party Issuer may link two transactions
1721	   involving the same Referenced Tokens by comparing the status claims
1722	   of the Referenced Token and therefore determine that they have
1723	   interacted with the same Holder.  It is therefore recommended to use
1724	   Status Lists for Referenced Token formats that have similar
1725	   unlinkability properties.

1727	12.6.  External Status Provider for Privacy

1729	   If the roles of the Status Issuer and the Status Provider are
1730	   performed by different entities, this may give additional privacy
1731	   assurances as the Issuer has no means to identify the Relying Party
1732	   or its request.

1734	   Third-Party hosting may also allow for greater scalability, as the
1735	   Status List Tokens may be served by operators with greater resources,
1736	   like CDNs, while still ensuring authenticity and integrity of Token
1737	   Status List, as it is signed by the Status Issuer.

1739	12.7.  Historical Resolution

1741	   By default, this specification only supports providing Status List
1742	   information for the most recent status information and does not allow
1743	   the lookup of historical information like a validity state at a
1744	   specific point in time.  There exists optional support for a query
1745	   parameter that allows these kind of historic lookups as described in
1746	   Section 8.4.  There are scenarios where such a functionality is
1747	   necessary, but this feature should only be implemented when the
1748	   scenario and the consequences of enabling historical resolution are
1749	   fully understood.

1751	   There are strong privacy concerns that have to be carefully taken
1752	   into consideration when providing a mechanism that allows historic
1753	   requests for status information - see Section 12.3 for more details.
1754	   Support for this functionality is optional and Implementers are
1755	   RECOMMENDED to not support historic requests unless there are strong
1756	   reasons to do so and after carefully considering the privacy
1757	   implications.

1759	12.8.  Status Types

1761	   As previously explained, there is the potential risk of observability
1762	   by Relying Parties (see Section 12.3) and Outsiders (see
1763	   Section 12.4).  That means that any Status Type that transports
1764	   information beyond the routine statuses VALID and INVALID about a
1765	   Referenced Token can leak information to other parties.  This
1766	   document defines one additional Status Type with "SUSPENDED" that
1767	   conveys such additional information, but in practice all statuses
1768	   other than VALID and INVALID are likely to contain information with
1769	   privacy implications.

1771	   Ecosystems that want to use other Status Types than "VALID" and
1772	   "INVALID" should consider the possible leakage of data and profiling
1773	   possibilities before doing so and evaluate if revocation and re-
1774	   issuance might a better fit for their use-case.

1776	13.  Operational Considerations

1778	13.1.  Token Lifecycle

1780	   The lifetime of a Status List Token depends on the lifetime of its
1781	   Referenced Tokens.  Once all Referenced Tokens are expired, the
1782	   Issuer may stop serving the Status List Token.

1784	13.2.  Linkability Mitigation

1786	   Referenced Tokens may be regularly re-issued to mitigate the
1787	   linkability of presentations to Relying Parties.  In this case, every
1788	   re-issued Referenced Token MUST have a fresh Status List entry in
1789	   order to prevent the index value from becoming a possible source of
1790	   correlation.

1792	   Referenced Tokens may also be issued in batches and be presented by
1793	   Holders in a one-time-use policy to avoid linkability.  In this case,
1794	   every Referenced Token MUST have a dedicated Status List entry and
1795	   MAY be spread across multiple Status List Tokens.  Batch revocation
1796	   of a batch of Referenced Tokens might reveal that they are all
1797	   members of the same batch.

1799	   Beware, that this mechanism solves linkability issues between Relying
1800	   Parties, but does not prevent traceability by Issuers.

1802	13.3.  Default Values and Double Allocation

1804	   The Status Issuer is RECOMMENDED to initialize the Status List byte
1805	   array with a default value provided as an initialization parameter by
1806	   the Issuer of the Referenced Token.  The Issuer is RECOMMENDED to use
1807	   a default value that represents the most common value for its
1808	   Referenced Tokens to avoid an update during issuance (usually 0x00,
1809	   VALID).  This preserves the benefits from compression and effectively
1810	   hides the number of managed Referenced Tokens since an unused index
1811	   value can not be distinguished from a valid Referenced Token.

1813	   The Status Issuer is RECOMMENDED to prevent double allocation, i.e.
1814	   re-using the same uri and idx for multiple Referenced Tokens (since
1815	   uri and idx form a unique identifier that might be used for tracking,
1816	   see Section 12 for more details).  The Status Issuer MUST prevent any
1817	   unintended double allocation.

1819	13.4.  Status List Size

1821	   The storage and transmission size of the Status Issuer's Status List
1822	   Tokens depend on:

1824	   *  the size of the Status List, i.e. the number of Referenced Tokens

1826	   *  the revocation rate and distribution of the Status List data (due
1827	      to compression, revocation rates close to 0% or 100% create lowest
1828	      sizes while revocation rates closer to 50% and random distribution
1829	      create highest sizes)

1831	   *  the lifetime of Referenced Tokens (shorter lifetimes allows for
1832	      earlier retirement of Status List Tokens)

1834	   The Status List Issuer may increase the size of a Status List if it
1835	   requires indices for additional Referenced Tokens.  It is RECOMMENDED
1836	   that the size of a Status List in bits is divisible in bytes (8 bits)
1837	   without a remainder, i.e. size-in-bits % 8 = 0.

1839	   The Status List Issuer may divide its Referenced Tokens up into
1840	   multiple Status Lists to reduce the transmission size of an
1841	   individual Status List Token.  This may be useful for ecosystems
1842	   where some entities operate in constrained environments, e.g. for
1843	   mobile internet or embedded devices.  The Status List Issuer may
1844	   organize the Status List Tokens depending on the Referenced Token's
1845	   expiry date to align their lifecycles and allow for easier retiring
1846	   of Status List Tokens, however the Status Issuer must be aware of
1847	   possible privacy risks due to correlations.

1849	13.5.  External Status Issuer

1851	   If the roles of the Issuer of the Referenced Token and the Status
1852	   Issuer are performed by different entities, this may allow for use
1853	   cases that require revocation of Referenced Tokens to be managed by
1854	   different entities, e.g. for regulatory or privacy reasons.  In this
1855	   scenario both parties must align on:

1857	   *  the key and trust management as described in Section 11.3

1859	   *  parameters for the Status List

1861	      -  number of bits for the Status Type as described in Section 4

1863	      -  update cycle of the Issuer used for ttl in the Status List
1864	         Token as described in Section 5

1866	13.6.  External Status Provider for Scalability

1868	   If the roles of the Status Issuer and the Status Provider are
1869	   performed by different entities, this may allow for greater
1870	   scalability, as the Status List Tokens may be served by operators
1871	   with greater resources, like CDNs.  At the same time the authenticity
1872	   and integrity of Token Status List is still guaranteed, as it is
1873	   signed by the Status Issuer.

1875	13.7.  Status List Update Interval and Caching

1877	   Status Issuers have two options to communicate their update interval
1878	   policy for the status of their Referenced Tokens:

1880	   *  the exp claim specifies an absolute timestamp, marking the point
1881	      in time when the Status List expires and MUST NOT be relied upon
1882	      any longer

1884	   *  the ttl claim represents a duration to be interpreted relative to
1885	      the time the Status List is fetched, indicating when a new version
1886	      of the Status List may be available

1888	   Both ttl and exp are RECOMMENDED to be used by the Status Issuer.

1890	   When fetching a Status List Token, Relying Parties must carefully
1891	   evaluate how long a Status List is cached for.  Collectively the iat,
1892	   exp and ttl claims when present in a Status List Token communicate
1893	   how long a Status List should be cached and should be considered
1894	   valid for.  Relying Parties have different options for caching the
1895	   Status List:

1897	   *  After time of fetching, the Relying Party caches the Status List
1898	      for time duration of ttl before making checks for updates.  This
1899	      method is RECOMMENDED to distribute the load for the Status
1900	      Provider.

1902	   *  After initial fetching, the Relying Party checks for updates at
1903	      time of iat + ttl.  This method ensures the most up-to-date
1904	      information for critical use cases.  The Relying Party should
1905	      account a minimal offset due to the signing and distribution
1906	      process of the Status Issuer.

1908	   *  If no ttl is given, then Relying Party SHOULD check for updates
1909	      latest after the time of exp.

1911	   Ultimately, it's the Relying Parties decision how often to check for
1912	   updates, ecosystems may define their own guidelines and policies for
1913	   updating the Status List information.  Clients should ensure that exp
1914	   and ttl are within reasonable bounds before creating requests to get
1915	   a fresh Status List Token (see Section 11.5 for more details).

1917	   The following diagram illustrates the relationship between these
1918	   claims and how they are designed to influence caching:

1920	          Time of        Check for        Check for        Check for
1921	          Fetching        updates          updates          updates

1923	    iat     │                │                │                │    exp
1924	            │                │                │                │
1925	     │      │                │                │                │     │
1926	     │      │                │                │                │     │
1927	     │      │                │                │                │     │
1928	     │      │                │                │                │     │
1929	     │      │      ttl       │      ttl       │      ttl       │     │
1930	     │      │ ─────────────► │ ─────────────► │ ─────────────► │ ──► │
1931	     │      │                │                │                │     │
1932	     │      │                │                │                │     │
1933	     │                                                               │
1934	   ──┼───────────────────────────────────────────────────────────────┼─►
1935	     │                                                               │

1937	13.8.  Relying Parties avoiding correlatable Information

1939	   If the Relying Party does not require the Referenced Token or the
1940	   Status List Token for further processing, it is RECOMMENDED to delete
1941	   correlatable information, in particular:

1943	   *  the status claim in the Referenced Token (after the validation)

1945	   *  the Status List Token itself (after expiration or update)

1947	   The Relying Party should instead only keep the needed fields from the
1948	   Referenced Token.

1950	13.9.  Status List Formats

1952	   This specification defines 2 different token formats of the Status
1953	   List:

1955	   *  JWT

1957	   *  CWT

1959	   This specification states no requirements to not mix different
1960	   formats like a CBOR based Referenced Token using a JWT for the Status
1961	   List, but the expectation is that within an ecosystem, a choice for
1962	   specific formats is made.  Within such an ecosystem, only support for
1963	   those selected variants is required and implementations should know
1964	   what to expect via a profile.

1966	14.  IANA Considerations
1967	14.1.  JSON Web Token Claims Registration

1969	   This specification requests registration of the following Claims in
1970	   the IANA "JSON Web Token Claims" registry [IANA.JWT] established by
1971	   [RFC7519].

1973	14.1.1.  Registry Contents

1975	   *  Claim Name: status

1977	   *  Claim Description: A JSON object containing a reference to a
1978	      status mechanism from the JWT Status Mechanisms Registry.

1980	   *  Change Controller: IETF

1982	   *  Specification Document(s): Section 6.1 of this specification

1984	   *  Claim Name: status_list

1986	   *  Claim Description: A JSON object containing up-to-date status
1987	      information on multiple tokens using the Token Status List
1988	      mechanism.

1990	   *  Change Controller: IETF

1992	   *  Specification Document(s): Section 5.1 of this specification

1994	   *  Claim Name: ttl

1996	   *  Claim Description: Time to Live

1998	   *  Change Controller: IETF

2000	   *  Specification Document(s): Section 5.1 of this specification

2002	14.2.  JWT Status Mechanisms Registry

2004	   This specification establishes the IANA "JWT Status Mechanisms"
2005	   registry for JWT "status" member values and adds it to the "JSON Web
2006	   Token (JWT)" registry group at https://www.iana.org/assignments/jwt.
2007	   The registry records the status mechanism member and a reference to
2008	   the specification that defines it.

2010	   JWT Status Mechanisms are registered by Specification Required
2011	   [RFC8126] after a three-week review period on the jwt-reg-
2012	   review@ietf.org mailing list, on the advice of one or more Designated
2013	   Experts.  However, to allow for the allocation of names prior to
2014	   publication, the Designated Expert(s) may approve registration once
2015	   they are satisfied that such a specification will be published.

2017	   Registration requests sent to the mailing list for review should use
2018	   an appropriate subject (e.g., "Request to register JWT Status
2019	   Mechanism: example").

2021	   Within the review period, the Designated Expert(s) will either
2022	   approve or deny the registration request, communicating this decision
2023	   to the review list and IANA.  Denials should include an explanation
2024	   and, if applicable, suggestions as to how to make the request
2025	   successful.

2027	   IANA must only accept registry updates from the Designated Expert(s)
2028	   and should direct all requests for registration to the review mailing
2029	   list.

2031	14.2.1.  Registration Template

2033	   Status Mechanism Value:

2035	      The name requested (e.g., "status_list").  The name is case
2036	      sensitive.  Names may not match other registered names in a case-
2037	      insensitive manner unless the Designated Experts state that there
2038	      is a compelling reason to allow an exception.

2040	   Status Mechanism Description:

2042	      Brief description of the status mechanism.

2044	   Change Controller:

2046	      For IETF Stream RFCs, list the IETF.  For others, give the name of
2047	      the responsible party.  Other details (e.g., postal address, email
2048	      address, home page URI) may also be included.

2050	   Specification Document(s):

2052	      Reference to the document or documents that specify the parameter,
2053	      preferably including URIs that can be used to retrieve copies of
2054	      the documents.  An indication of the relevant sections may also be
2055	      included but is not required.

2057	14.2.2.  Initial Registry Contents

2059	   *  Status Mechanism Value: status_list

2061	   *  Status Mechanism Description: A Token Status List containing up-
2062	      to-date status information on multiple tokens.

2064	   *  Change Controller: IETF

2066	   *  Specification Document(s): Section 6.2 of this specification

2068	14.3.  CBOR Web Token Claims Registration

2070	   This specification requests registration of the following Claims in
2071	   the IANA "CBOR Web Token (CWT) Claims" registry [IANA.CWT]
2072	   established by [RFC8392].

2074	14.3.1.  Registry Contents

2076	   *  Claim Name: status

2078	   *  Claim Description: A CBOR structure containing a reference to a
2079	      status mechanism from the CWT Status Mechanisms Registry.

2081	   *  JWT Claim Name: status

2083	   *  Claim Key: TBD (requested assignment 65535)

2085	   *  Claim Value Type: map

2087	   *  Change Controller: IETF

2089	   *  Reference: Section 6.1 of this specification

2091	   *  Claim Name: status_list

2093	   *  Claim Description: A CBOR structure containing up-to-date status
2094	      information on multiple tokens using the Token Status List
2095	      mechanism.

2097	   *  JWT Claim Name: status_list

2099	   *  Claim Key: TBD (requested assignment 65533)
2100	   *  Claim Value Type: map

2102	   *  Change Controller: IETF

2104	   *  Specification Document(s): Section 5.2 of this specification

2106	   *  Claim Name: ttl

2108	   *  Claim Description: Time to Live

2110	   *  JWT Claim Name: ttl

2112	   *  Claim Key: TBD (requested assignment 65534)

2114	   *  Claim Value Type: unsigned integer

2116	   *  Change Controller: IETF

2118	   *  Specification Document(s): Section 5.2 of this specification

2120	14.4.  CWT Status Mechanisms Registry

2122	   This specification establishes the IANA "CWT Status Mechanisms"
2123	   registry for CWT "status" member values and adds it to the "CBOR Web
2124	   Token (CWT) Claims" registry group at
2125	   https://www.iana.org/assignments/cwt.  The registry records the
2126	   status mechanism member and a reference to the specification that
2127	   defines it.

2129	   CWT Status Mechanisms are registered by Specification Required
2130	   [RFC8126] after a three-week review period on the cwt-reg-
2131	   review@ietf.org mailing list, on the advice of one or more Designated
2132	   Experts.  However, to allow for the allocation of names prior to
2133	   publication, the Designated Expert(s) may approve registration once
2134	   they are satisfied that such a specification will be published.

2136	   Registration requests sent to the mailing list for review should use
2137	   an appropriate subject (e.g., "Request to register CWT Status
2138	   Mechanism: example").

2140	   Within the review period, the Designated Expert(s) will either
2141	   approve or deny the registration request, communicating this decision
2142	   to the review list and IANA.  Denials should include an explanation
2143	   and, if applicable, suggestions as to how to make the request
2144	   successful.

2146	   IANA must only accept registry updates from the Designated Expert(s)
2147	   and should direct all requests for registration to the review mailing
2148	   list.

2150	14.4.1.  Registration Template

2152	   Status Mechanism Value:

2154	      The name requested (e.g., "status_list").  The name is case
2155	      sensitive.  Names may not match other registered names in a case-
2156	      insensitive manner unless the Designated Experts state that there
2157	      is a compelling reason to allow an exception.

2159	   Status Mechanism Description:

2161	      Brief description of the status mechanism.

2163	   Change Controller:

2165	      For IETF Stream RFCs, list the IETF.  For others, give the name of
2166	      the responsible party.  Other details (e.g., postal address, email
2167	      address, home page URI) may also be included.

2169	   Specification Document(s):

2171	      Reference to the document or documents that specify the parameter,
2172	      preferably including URIs that can be used to retrieve copies of
2173	      the documents.  An indication of the relevant sections may also be
2174	      included but is not required.

2176	14.4.2.  Initial Registry Contents

2178	   *  Status Mechanism Value: status_list

2180	   *  Status Mechanism Description: A Token Status List containing up-
2181	      to-date status information on multiple tokens.

2183	   *  Change Controller: IETF

2185	   *  Specification Document(s): Section 6.3 of this specification

2187	14.5.  OAuth Status Types Registry

2189	   This specification establishes the IANA "OAuth Status Types" registry
2190	   for Status List values and adds it to the "OAuth Parameters" registry
2191	   group at https://www.iana.org/assignments/oauth-parameters.  The
2192	   registry records a human readable label, the bit representation and a
2193	   common description for it.

2195	   Status Types are registered by Specification Required [RFC8126] after
2196	   a two-week review period on the oauth-ext-review@ietf.org mailing
2197	   list, on the advice of one or more Designated Experts.  However, to
2198	   allow for the allocation of names prior to publication, the
2199	   Designated Expert(s) may approve registration once they are satisfied
2200	   that such a specification will be published.

2202	   Registration requests sent to the mailing list for review should use
2203	   an appropriate subject (e.g., "Request to register Status Type name:
2204	   example").

2206	   Within the review period, the Designated Expert(s) will either
2207	   approve or deny the registration request, communicating this decision
2208	   to the review list and IANA.  Denials should include an explanation
2209	   and, if applicable, suggestions as to how to make the request
2210	   successful.

2212	   IANA must only accept registry updates from the Designated Expert(s)
2213	   and should direct all requests for registration to the review mailing
2214	   list.

2216	14.5.1.  Registration Template

2218	   Status Type Name:

2220	      The name is a human-readable case insensitive label for the Status
2221	      Type that helps to talk about the status of Referenced Token in
2222	      common language.

2224	   Status Type Description:

2226	      Brief description of the Status Type and optional examples.

2228	   Status Type value:

2230	      The bit representation of the Status Type in a byte hex
2231	      representation.  Valid Status Type values range from 0x00-0xFF.
2232	      Values are filled up with zeros if they have less than 8 bits.

2234	   Change Controller:

2236	      For IETF Stream RFCs, list the IETF.  For others, give the name of
2237	      the responsible party.  Other details (e.g., postal address, email
2238	      address, home page URI) may also be included.

2240	   Specification Document(s):

2242	      Reference to the document or documents that specify the parameter,
2243	      preferably including URIs that can be used to retrieve copies of
2244	      the documents.  An indication of the relevant sections may also be
2245	      included but is not required.

2247	14.5.2.  Initial Registry Contents

2249	   *  Status Type Name: VALID

2251	   *  Status Type Description: The status of the Referenced Token is
2252	      valid, correct or legal.

2254	   *  Status Type value: 0x00

2256	   *  Change Controller: IETF

2258	   *  Specification Document(s): Section 7 of this specification

2260	   *  Status Type Name: INVALID

2262	   *  Status Type Description: The status of the Referenced Token is
2263	      revoked, annulled, taken back, recalled or cancelled.

2265	   *  Status Type value: 0x01

2267	   *  Change Controller: IETF

2269	   *  Specification Document(s): Section 7 of this specification

2271	   *  Status Type Name: SUSPENDED

2273	   *  Status Type Description: The status of the Referenced Token is
2274	      temporarily invalid, hanging or debarred from privilege.  This
2275	      state is usually temporary.

2277	   *  Status Type value: 0x02

2279	   *  Change Controller: IETF

2281	   *  Specification Document(s): Section 7 of this specification

2283	   *  Status Type Name: APPLICATION_SPECIFIC
2284	   *  Status Type Description: The status of the Referenced Token is
2285	      application specific.

2287	   *  Status Type value: 0x03

2289	   *  Change Controller: IETF

2291	   *  Specification Document(s): Section 7 of this specification

2293	   *  Status Type Name: APPLICATION_SPECIFIC

2295	   *  Status Type Description: The status of the Referenced Token is
2296	      application specific.

2298	   *  Status Type value: 0x0C-0xOF

2300	   *  Change Controller: IETF

2302	   *  Specification Document(s): Section 7 of this specification

2304	14.6.  OAuth Parameters Registration

2306	   This specification requests registration of the following values in
2307	   the IANA "OAuth Authorization Server Metadata" registry
2308	   [IANA.OAuth.Params] established by [RFC8414].

2310	   *  Metadata Name: status_list_aggregation_endpoint

2312	   *  Metadata Description: URL of the Authorization Server aggregating
2313	      OAuth Token Status List URLs for token status management.

2315	   *  Change Controller: IESG

2317	   *  Reference: Section 9 of this specification

2319	14.7.  Media Type Registration

2321	   This section requests registration of the following media types
2322	   [RFC2046] in the "Media Types" registry [IANA.MediaTypes] in the
2323	   manner described in [RFC6838].

2325	   To indicate that the content is an JWT-based Status List:

2327	   *  Type name: application
2328	   *  Subtype name: statuslist+jwt

2330	   *  Required parameters: n/a

2332	   *  Optional parameters: n/a

2334	   *  Encoding considerations: See Section 5.1 of this specification

2336	   *  Security considerations: See Section 11 of this specification

2338	   *  Interoperability considerations: n/a

2340	   *  Published specification: this specification

2342	   *  Applications that use this media type: Applications using this
2343	      specification for updated status information of tokens

2345	   *  Fragment identifier considerations: n/a

2347	   *  Additional information: n/a

2349	   *  Person & email address to contact for further information: Paul
2350	      Bastian, paul.bastian@posteo.de

2352	   *  Intended usage: COMMON

2354	   *  Restrictions on usage: none

2356	   *  Author: Paul Bastian, paul.bastian@posteo.de

2358	   *  Change controller: IETF

2360	   *  Provisional registration?  No

2362	   To indicate that the content is an CWT-based Status List:

2364	   *  Type name: application

2366	   *  Subtype name: statuslist+cwt

2368	   *  Required parameters: n/a

2370	   *  Optional parameters: n/a

2372	   *  Encoding considerations: See Section 5.2 of this specification

2374	   *  Security considerations: See Section 11 of this specification
2375	   *  Interoperability considerations: n/a

2377	   *  Published specification: this specification

2379	   *  Applications that use this media type: Applications using this
2380	      specification for updated status information of tokens

2382	   *  Fragment identifier considerations: n/a

2384	   *  Additional information: n/a

2386	   *  Person & email address to contact for further information: Paul
2387	      Bastian, paul.bastian@posteo.de

2389	   *  Intended usage: COMMON

2391	   *  Restrictions on usage: none

2393	   *  Author: Paul Bastian, paul.bastian@posteo.de

2395	   *  Change controller: IETF

2397	   *  Provisional registration?  No

2399	14.8.  CoAP Content-Format Registrations

2401	   IANA is requested to register the following Content-Format numbers in
2402	   the "CoAP Content-Formats" sub-registry, within the "Constrained
2403	   RESTful Environments (CoRE) Parameters" Registry [IANA.Core.Params]:

2405	   *  Content Type: application/statuslist+cwt

2407	   *  Content Coding: -

2409	   *  ID: TBD

2411	   *  Reference: this specification

2413	14.9.  X.509 Certificate Extended Key Purpose OID Registration

2415	   IANA is requested to register the following OID "1.3.6.1.5.5.7.3.TBD"
2416	   with a description of "id-kp-oauthStatusSigning" in the "SMI Security
2417	   for PKIX Extended Key Purpose" registry (1.3.6.1.5.5.7.3).  This OID
2418	   is defined in section Section 10.

2420	   IANA is requested to register the following OID "1.3.6.1.5.5.7.0.TBD"
2421	   with a description of "id-mod-oauth-status-signing-eku" in the "SMI
2422	   Security for PKIX Module Identifier" registry (1.3.6.1.5.5.7.0).
2423	   This OID is defined in section Appendix A.

2425	15.  Acknowledgments

2427	   We would like to thank Andrii Deinega, Brian Campbell, Dan Moore,
2428	   Denis Pinkas, Filip Skokan, Francesco Marino, Giuseppe De Marco,
2429	   Hannes Tschofenig, Kristina Yasuda, Markus Kreusch, Martijn Haring,
2430	   Michael B.  Jones, Micha Kraus, Michael Schwartz, Mike Prorock, Mirko
2431	   Mollik, Oliver Terbu, Orie Steele, Rifaat Shekh-Yusef, Rohan Mahy,
2432	   Takahiko Kawasaki, Timo Glastra and Torsten Lodderstedt

2434	   for their valuable contributions, discussions and feedback to this
2435	   specification.

2437	16.  References

2439	16.1.  Normative References

2441	   [CORS]     WHATWG, "Fetch Living Standard", n.d.,
2442	              <https://fetch.spec.whatwg.org/commit-
2443	              snapshots/4775fcb48042c8411df497c0b7cf167b4240004f/#http-
2444	              cors-protocol>.

2446	   [RFC1950]  Deutsch, P. and J. Gailly, "ZLIB Compressed Data Format
2447	              Specification version 3.3", RFC 1950,
2448	              DOI 10.17487/RFC1950, May 1996,
2449	              <https://www.rfc-editor.org/rfc/rfc1950>.

2451	   [RFC1951]  Deutsch, P., "DEFLATE Compressed Data Format Specification
2452	              version 1.3", RFC 1951, DOI 10.17487/RFC1951, May 1996,
2453	              <https://www.rfc-editor.org/rfc/rfc1951>.

2455	   [RFC2046]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
2456	              Extensions (MIME) Part Two: Media Types", RFC 2046,
2457	              DOI 10.17487/RFC2046, November 1996,
2458	              <https://www.rfc-editor.org/rfc/rfc2046>.

2460	   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
2461	              Requirement Levels", BCP 14, RFC 2119,
2462	              DOI 10.17487/RFC2119, March 1997,
2463	              <https://www.rfc-editor.org/rfc/rfc2119>.

2465	   [RFC3986]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
2466	              Resource Identifier (URI): Generic Syntax", STD 66,
2467	              RFC 3986, DOI 10.17487/RFC3986, January 2005,
2468	              <https://www.rfc-editor.org/rfc/rfc3986>.

2470	   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
2471	              Housley, R., and W. Polk, "Internet X.509 Public Key
2472	              Infrastructure Certificate and Certificate Revocation List
2473	              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
2474	              <https://www.rfc-editor.org/rfc/rfc5280>.

2476	   [RFC6838]  Freed, N., Klensin, J., and T. Hansen, "Media Type
2477	              Specifications and Registration Procedures", BCP 13,
2478	              RFC 6838, DOI 10.17487/RFC6838, January 2013,
2479	              <https://www.rfc-editor.org/rfc/rfc6838>.

2481	   [RFC7515]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
2482	              Signature (JWS)", RFC 7515, DOI 10.17487/RFC7515, May
2483	              2015, <https://www.rfc-editor.org/rfc/rfc7515>.

2485	   [RFC7519]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
2486	              (JWT)", RFC 7519, DOI 10.17487/RFC7519, May 2015,
2487	              <https://www.rfc-editor.org/rfc/rfc7519>.

2489	   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
2490	              Writing an IANA Considerations Section in RFCs", BCP 26,
2491	              RFC 8126, DOI 10.17487/RFC8126, June 2017,
2492	              <https://www.rfc-editor.org/rfc/rfc8126>.

2494	   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
2495	              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
2496	              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

2498	   [RFC8259]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
2499	              Interchange Format", STD 90, RFC 8259,
2500	              DOI 10.17487/RFC8259, December 2017,
2501	              <https://www.rfc-editor.org/rfc/rfc8259>.

2503	   [RFC8392]  Jones, M., Wahlstroem, E., Erdtman, S., and H. Tschofenig,
2504	              "CBOR Web Token (CWT)", RFC 8392, DOI 10.17487/RFC8392,
2505	              May 2018, <https://www.rfc-editor.org/rfc/rfc8392>.

2507	   [RFC8725]  Sheffer, Y., Hardt, D., and M. Jones, "JSON Web Token Best
2508	              Current Practices", BCP 225, RFC 8725,
2509	              DOI 10.17487/RFC8725, February 2020,
2510	              <https://www.rfc-editor.org/rfc/rfc8725>.

2512	   [RFC8949]  Bormann, C. and P. Hoffman, "Concise Binary Object
2513	              Representation (CBOR)", STD 94, RFC 8949,
2514	              DOI 10.17487/RFC8949, December 2020,
2515	              <https://www.rfc-editor.org/rfc/rfc8949>.

2517	   [RFC9052]  Schaad, J., "CBOR Object Signing and Encryption (COSE):
2518	              Structures and Process", STD 96, RFC 9052,
2519	              DOI 10.17487/RFC9052, August 2022,
2520	              <https://www.rfc-editor.org/rfc/rfc9052>.

2522	   [RFC9110]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
2523	              Ed., "HTTP Semantics", STD 97, RFC 9110,
2524	              DOI 10.17487/RFC9110, June 2022,
2525	              <https://www.rfc-editor.org/rfc/rfc9110>.

2527	   [RFC9596]  Jones, M.B. and O. Steele, "CBOR Object Signing and
2528	              Encryption (COSE) "typ" (type) Header Parameter",
2529	              RFC 9596, DOI 10.17487/RFC9596, June 2024,
2530	              <https://www.rfc-editor.org/rfc/rfc9596>.

2532	   [X.680]    International Telecommunications Union, "Information
2533	              Technology - Abstract Syntax Notation One (ASN.1):
2534	              Specification of basic notation", February 2021.

2536	   [X.690]    International Telecommunications Union, "Information
2537	              Technology - ASN.1 encoding rules: Specification of Basic
2538	              Encoding Rules (BER), Canonical Encoding Rules (CER) and
2539	              Distinguished Encoding Rules (DER)", February 2021.

2541	16.2.  Informative References

2543	   [IANA.Core.Params]
2544	              IANA, "Constrained RESTful Environments (CoRE)
2545	              Parameters", n.d., <https://www.iana.org/assignments/core-
2546	              parameters/core-parameters.xhtml>.

2548	   [IANA.CWT] IANA, "CBOR Web Token (CWT) Claims", n.d.,
2549	              <https://www.iana.org/assignments/cwt/cwt.xhtml>.

2551	   [IANA.JWT] IANA, "JSON Web Token Claims", n.d.,
2552	              <https://www.iana.org/assignments/jwt/jwt.xhtml>.

2554	   [IANA.MediaTypes]
2555	              IANA, "Media Types", n.d.,
2556	              <https://www.iana.org/assignments/media-types/media-
2557	              types.xhtml>.

2559	   [IANA.OAuth.Params]
2560	              IANA, "OAuth Authorization Server Metadata", n.d.,
2561	              <https://www.iana.org/assignments/oauth-parameters/oauth-
2562	              parameters.xhtml#authorization-server-metadata>.

2564	   [ISO.mdoc] ISO/IEC JTC 1/SC 17, "ISO/IEC 18013-5:2021 ISO-compliant
2565	              driving licence", n.d..

2567	   [RFC6749]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
2568	              RFC 6749, DOI 10.17487/RFC6749, October 2012,
2569	              <https://www.rfc-editor.org/rfc/rfc6749>.

2571	   [RFC7662]  Richer, J., Ed., "OAuth 2.0 Token Introspection",
2572	              RFC 7662, DOI 10.17487/RFC7662, October 2015,
2573	              <https://www.rfc-editor.org/rfc/rfc7662>.

2575	   [RFC7800]  Jones, M., Bradley, J., and H. Tschofenig, "Proof-of-
2576	              Possession Key Semantics for JSON Web Tokens (JWTs)",
2577	              RFC 7800, DOI 10.17487/RFC7800, April 2016,
2578	              <https://www.rfc-editor.org/rfc/rfc7800>.

2580	   [RFC8414]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
2581	              Authorization Server Metadata", RFC 8414,
2582	              DOI 10.17487/RFC8414, June 2018,
2583	              <https://www.rfc-editor.org/rfc/rfc8414>.

2585	   [RFC8610]  Birkholz, H., Vigano, C., and C. Bormann, "Concise Data
2586	              Definition Language (CDDL): A Notational Convention to
2587	              Express Concise Binary Object Representation (CBOR) and
2588	              JSON Data Structures", RFC 8610, DOI 10.17487/RFC8610,
2589	              June 2019, <https://www.rfc-editor.org/rfc/rfc8610>.

2591	   [RFC9458]  Thomson, M. and C. A. Wood, "Oblivious HTTP", RFC 9458,
2592	              DOI 10.17487/RFC9458, January 2024,
2593	              <https://www.rfc-editor.org/rfc/rfc9458>.

2595	   [RFC9562]  Davis, K., Peabody, B., and P. Leach, "Universally Unique
2596	              IDentifiers (UUIDs)", RFC 9562, DOI 10.17487/RFC9562, May
2597	              2024, <https://www.rfc-editor.org/rfc/rfc9562>.

2599	   [SD-JWT.VC]
2600	              Terbu, O., Fett, D., and B. Campbell, "SD-JWT-based
2601	              Verifiable Credentials (SD-JWT VC)", Work in Progress,
2602	              Internet-Draft, draft-ietf-oauth-sd-jwt-vc-13, 6 November
2603	              2025, <https://datatracker.ietf.org/doc/html/draft-ietf-
2604	              oauth-sd-jwt-vc-13>.

2606	   [smith2020let]
2607	              Smith, T., Dickinson, L., and K. Seamons, "Let's revoke:
2608	              Scalable global certificate revocation", Network and
2609	              Distributed Systems Security (NDSS) Symposium 2020 , n.d.,
2610	              <https://www.ndss-symposium.org/ndss-paper/lets-revoke-
2611	              scalable-global-certificate-revocation/>.

2613	   [W3C.SL]   Longley, D., Sporny, M., and O. Steele, "W3C Bitstring
2614	              Status List v1.0", December 2024,
2615	              <https://www.w3.org/TR/vc-bitstring-status-list/>.

2617	Appendix A.  ASN.1 Module

2619	   The following module adheres to ASN.1 specifications [X.680] and
2620	   [X.690].  It defines the OID used for OAuth Status Mechanism Key
2621	   Extended Key Usage.

2623	   <CODE BEGINS>
2624	     OauthStatusSigning-EKU
2625	       { iso(1) identified-organization(3) dod(6) internet(1)
2626	         security(5) mechanisms(5) pkix(7) id-mod(0)
2627	         id-mod-oauth-status-signing-eku (TBD) }

2629	     DEFINITIONS IMPLICIT TAGS ::=
2630	     BEGIN

2632	     -- OID Arc

2634	     id-kp OBJECT IDENTIFIER ::=
2635	       { iso(1) identified-organization(3) dod(6) internet(1)
2636	         security(5) mechanisms(5) pkix(7) kp(3) }

2638	     -- OAuth Extended Key Usage

2640	     id-kp-oauthStatusSigning OBJECT IDENTIFIER ::= { id-kp TBD }

2642	     END
2643	   <CODE ENDS>

2645	Appendix B.  Size Comparison

2647	   The following tables show a size comparison for a Status List
2648	   (compressed byte array as defined in Section 4.1) and a compressed
2649	   Byte Array of UUIDs [RFC9562] (as an approximation to the list of IDs
2650	   of Referenced Tokens in a Certificate Revocation List).  Readers must
2651	   be aware that these are not sizes for complete Status List Tokens in
2652	   JSON/CBOR nor Certificate Revocation Lists (CRLs), as they don't
2653	   contain metadata, certificates, and signatures.

2655	   If no further metadata is provided in Status List Tokens or CRLs,
2656	   then the size of Status Lists or arrays of Certificate ids
2657	   (represented as UUIDs) will be the main factors deciding on the
2658	   overall size of a Status List Token or CRL, respectively.

2660	Size of Status Lists for varying amount of entries and revocation rates

2662	   +====+=====+=====+======+======+=====+=====+======+=====+======+====+
2663	   |Size|0.01%|0.1% |1%    |2%    |5%   |10%  |25%   |50%  |75%   |100%|
2664	   +====+=====+=====+======+======+=====+=====+======+=====+======+====+
2665	   |100k|81 B |252 B|1.4 KB|2.3   |4.5  |6.9  |10.2  |12.2 |10.2  |35 B|
2666	   |    |     |     |      |KB    |KB   |KB   |KB    |KB   |KB    |    |
2667	   +----+-----+-----+------+------+-----+-----+------+-----+------+----+
2668	   |1M  |442 B|2.2  |13.7  |23.0  |43.9 |67.6 |102.2 |122.1|102.4 |144 |
2669	   |    |     |KB   |KB    |KB    |KB   |KB   |KB    |KB   |KB    |B   |
2670	   +----+-----+-----+------+------+-----+-----+------+-----+------+----+
2671	   |10M |3.8  |21.1 |135.4 |230.0 |437.0|672.9|1023.4|1.2  |1023.5|1.2 |
2672	   |    |KB   |KB   |KB    |KB    |KB   |KB   |KB    |MB   |KB    |KB  |
2673	   +----+-----+-----+------+------+-----+-----+------+-----+------+----+
2674	   |100M|38.3 |213.0|1.3 MB|2.2   |4.3  |6.6  |10.0  |11.9 |10.0  |11.9|
2675	   |    |KB   |KB   |      |MB    |MB   |MB   |MB    |MB   |MB    |KB  |
2676	   +----+-----+-----+------+------+-----+-----+------+-----+------+----+

2678	    Table 1: Status List Size examples for varying amount of entries and
2679	                              revocation rates

2681	Size of compressed array of UUIDv4 (128-bit UUIDs) for varying amount of
2682	entries and revocation rates

2684	   This is a simple approximation of a CRL using an array of UUIDs
2685	   without any additional metadata (128-bit UUID per revoked entry).

2687	   +====+=====+======+=====+=====+====+=====+=====+=====+=====+=======+
2688	   |Size|0.01%|0.1%  |1%   |2%   |5%  |10%  |25%  |50%  |75%  | 100%  |
2689	   +====+=====+======+=====+=====+====+=====+=====+=====+=====+=======+
2690	   |100k|219 B|1.6 KB|15.4 |29.7 |78.1|154.9|392.9|783.1|1.1  | 1.5   |
2691	   |    |     |      |KB   |KB   |KB  |KB   |KB   |KB   |MB   | MB    |
2692	   +----+-----+------+-----+-----+----+-----+-----+-----+-----+-------+
2693	   |1M  |1.6  |16.4  |157.7|310.4|781 |1.5  |3.8  |7.6  |11.4 | 15.3  |
2694	   |    |KB   |KB    |KB   |KB   |KB  |MB   |MB   |MB   |MB   | MB    |
2695	   +----+-----+------+-----+-----+----+-----+-----+-----+-----+-------+
2696	   |10M |15.3 |155.9 |1.5  |3.1  |7.6 |15.2 |38.2 |76.3 |114.4| 152.6 |
2697	   |    |KB   |KB    |MB   |MB   |MB  |MB   |MB   |MB   |MB   | MB    |
2698	   +----+-----+------+-----+-----+----+-----+-----+-----+-----+-------+
2699	   |100M|157.6|1.5 MB|15.3 |30.5 |76.3|152.6|381.4|762.9|1.1  | 1.5   |
2700	   |    |KB   |      |MB   |MB   |MB  |MB   |MB   |MB   |GB   | GB    |
2701	   +----+-----+------+-----+-----+----+-----+-----+-----+-----+-------+

2703	      Table 2: Size examples for 128-bit UUIDs for varying amount of
2704	                       entries and revocation rates

2706	Appendix C.  Test vectors for Status List encoding

2708	   All examples here are given in the form of JSON or CBOR payloads.
2709	   The examples are encoded according to Section 4.2 for JSON and
2710	   Section 4.3 for CBOR.  The CBOR examples are displayed as hex values.

2712	   All values that are not mentioned for the examples below can be
2713	   assumed to be 0 (VALID).  All examples are initialized with a size of
2714	   2^20 entries.

2716	C.1.  1-bit Status List

2718	   The following example uses a 1-bit Status List (2 possible values):

2720	   status[0] = 0b1
2721	   status[1993] = 0b1
2722	   status[25460] = 0b1
2723	   status[159495] = 0b1
2724	   status[495669] = 0b1
2725	   status[554353] = 0b1
2726	   status[645645] = 0b1
2727	   status[723232] = 0b1
2728	   status[854545] = 0b1
2729	   status[934534] = 0b1
2730	   status[1000345] = 0b1

2732	   JSON encoding:

2734	   {
2735	     "bits": 1,
2736	     "lst": "eNrt3AENwCAMAEGogklACtKQPg9LugC9k_ACvreiogE
2737	     AAKkeCQAAAAAAAAAAAAAAAAAAAIBylgQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2738	     AAAAAAAAAAAAAAAAAAAXG9IAAAAAAAAAPwsJAAAAAAAAAAAAAAAvhsSAAAAAAAAAAA
2739	     A7KpLAAAAAAAAAAAAAAAAAAAAAJsLCQAAAAAAAAAAADjelAAAAAAAAAAAKjDMAQAAA
2740	     ACAZC8L2AEb"
2741	   }

2743	   CBOR encoding:

2745	   a2646269747301636c737458bd78daeddc010dc0200c0041a88249400ad2903e0f4b
2746	   ba00bd93f002beb7a2a2010000a91e09000000000000000000000000000000807296
2747	   04000000000000000000000000000000000000000000000000000000000000000000
2748	   000000000000005c6f4800000000000000fc2c240000000000000000000000be1b12
2749	   000000000000000000ecaa4b000000000000000000000000000000009b0b09000000
2750	   00000000000038de9400000000000000002a30cc010000000080642f0bd8011b

2752	C.2.  2-bit Status List

2754	   The following example uses a 2-bit Status List (4 possible values):

2756	   status[0] = 0b01
2757	   status[1993] = 0b10
2758	   status[25460]= 0b01
2759	   status[159495] = 0b11
2760	   status[495669] = 0b01
2761	   status[554353] = 0b01
2762	   status[645645] = 0b10
2763	   status[723232] = 0b01
2764	   status[854545] = 0b01
2765	   status[934534] = 0b10
2766	   status[1000345] = 0b11

2768	   JSON encoding:

2770	   {
2771	     "bits": 2,
2772	     "lst": "eNrt2zENACEQAEEuoaBABP5VIO01fCjIHTMStt9ovGV
2773	     IAAAAAABAbiEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEB5WwIAAAAAA
2774	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2775	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAID0ugQAAAAAAAAAAAAAAAAAQG12SgAAA
2776	     AAAAAAAAAAAAAAAAAAAAAAAAOCSIQEAAAAAAAAAAAAAAAAAAAAAAAD8ExIAAAAAAAA
2777	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwJEuAQAAAAAAAAAAAAAAAAAAAAAAAMB9S
2778	     wIAAAAAAAAAAAAAAAAAAACoYUoAAAAAAAAAAAAAAEBqH81gAQw"
2779	   }

2781	   CBOR encoding:

2783	   a2646269747302636c737459013d78daeddb310d00211000412ea1a04004fe5520ed
2784	   357c28c81d3312b6df68bc65480000000000406e2101000000000000000000000000
2785	   0000000000000000000000000000000000000040795b020000000000000000000000
2786	   00000000000000000000000000000000000000000000000000000000000000000000
2787	   00000000000000000000000000000000000000000000000000000000000000000000
2788	   0080f4ba0400000000000000000000000000406d764a000000000000000000000000
2789	   000000000000000000e0922101000000000000000000000000000000000000fc1312
2790	   00000000000000000000000000000000000000000000000000000000000000c0912e
2791	   01000000000000000000000000000000000000c07d4b020000000000000000000000
2792	   00000000a8614a0000000000000000000000406a1fcd60010c

2794	C.3.  4-bit Status List

2796	   The following example uses a 4-bit Status List (16 possible values):

2798	   status[0] = 0b0001
2799	   status[1993] = 0b0010
2800	   status[35460] = 0b0011
2801	   status[459495] = 0b0100
2802	   status[595669] = 0b0101
2803	   status[754353] = 0b0110
2804	   status[845645] = 0b0111
2805	   status[923232] = 0b1000
2806	   status[924445] = 0b1001
2807	   status[934534] = 0b1010
2808	   status[1004534] = 0b1011
2809	   status[1000345] = 0b1100
2810	   status[1030203] = 0b1101
2811	   status[1030204] = 0b1110
2812	   status[1030205] = 0b1111

2814	   JSON encoding:

2816	   {
2817	     "bits": 4,
2818	     "lst": "eNrt0EENgDAQADAIHwImkIIEJEwCUpCEBBQRHOy35Li
2819	     1EjoOQGabAgAAAAAAAAAAAAAAAAAAACC1SQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2820	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2821	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2822	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2823	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABADrsCAAAAAAAAAAAAAAAAA
2824	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2825	     AAADoxaEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2826	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIIoCgAAAAAAAAAAAAAAAAA
2827	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACArpwKAAAAAAAAAAAAAAAAAAAAA
2828	     AAAAAAAAAAAAAAAAAAAAAAAAAAAAGhqVkAzlwIAAAAAiGVRAAAAAAAAAAAAAAAAAAA
2829	     AAAAAAAAAAAAAAAAAAAAAAABx3AoAgLpVAQAAAAAAAAAAAAAAwM89rwMAAAAAAAAAA
2830	     AjsA9xMBMA"
2831	   }

2833	   CBOR encoding:

2835	   a2646269747304636c737459024878daedd0410d8030100030081f0226908204244c
2836	   025290840414111cecb7e4b8b5123a0e40669b020000000000000000000000000000
2837	   0020b549010000000000000000000000000000000000000000000000000000000000
2838	   00000000000000000000000000000000000000000000000000000000000000000000
2839	   00000000000000000000000000000000000000000000000000000000000000000000
2840	   00000000000000000000000000000000000000000000000000000000000000000000
2841	   00000000000000000000000000000000000000000000000000000000000000000000
2842	   00000000000000000000000000000000000000000000000000000000000000000000
2843	   0000000000400ebb0200000000000000000000000000000000000000000000000000
2844	   00000000000000000000000000000000000000000000000000000000000000000000
2845	   000000000000e8c5a100000000000000000000000000000000000000000000000000
2846	   00000000000000000000000000000000000000000000000000000000000000000000
2847	   00000000000000000000000000000000000082280a00000000000000000000000000
2848	   00000000000000000000000000000000000000000000000000000000000080ae9c0a
2849	   00000000000000000000000000000000000000000000000000000000000000000000
2850	   000000686a5640339702000000008865510000000000000000000000000000000000
2851	   00000000000000000000000000000071dc0a0080ba55010000000000000000000000
2852	   c0cf3daf03000000000000000008ec03dc4c04c0

2854	C.4.  8-bit Status List

2856	   The following example uses a 8-bit Status List (256 possible values):

2858	   status[233478] = 0b00000000
2859	   status[52451] = 0b00000001
2860	   status[576778] = 0b00000010
2861	   status[513575] = 0b00000011
2862	   status[468106] = 0b00000100
2863	   status[292632] = 0b00000101
2864	   status[214947] = 0b00000110
2865	   status[182323] = 0b00000111
2866	   status[884834] = 0b00001000
2867	   status[66653] = 0b00001001
2868	   status[62489] = 0b00001010
2869	   status[196493] = 0b00001011
2870	   status[458517] = 0b00001100
2871	   status[487925] = 0b00001101
2872	   status[55649] = 0b00001110
2873	   status[416992] = 0b00001111
2874	   status[879796] = 0b00010000
2875	   status[462297] = 0b00010001
2876	   status[942059] = 0b00010010
2877	   status[583408] = 0b00010011
2878	   status[13628] = 0b00010100
2879	   status[334829] = 0b00010101
2880	   status[886286] = 0b00010110
2881	   status[713557] = 0b00010111
2882	   status[582738] = 0b00011000
2883	   status[326064] = 0b00011001
2884	   status[451545] = 0b00011010
2885	   status[705889] = 0b00011011
2886	   status[214350] = 0b00011100
2887	   status[194502] = 0b00011101
2888	   status[796765] = 0b00011110
2889	   status[202828] = 0b00011111
2890	   status[752834] = 0b00100000
2891	   status[721327] = 0b00100001
2892	   status[554740] = 0b00100010
2893	   status[91122] = 0b00100011
2894	   status[963483] = 0b00100100
2895	   status[261779] = 0b00100101
2896	   status[793844] = 0b00100110
2897	   status[165255] = 0b00100111
2898	   status[614839] = 0b00101000
2899	   status[758403] = 0b00101001
2900	   status[403258] = 0b00101010
2901	   status[145867] = 0b00101011
2902	   status[96100] = 0b00101100
2903	   status[477937] = 0b00101101
2904	   status[606890] = 0b00101110
2905	   status[167335] = 0b00101111
2906	   status[488197] = 0b00110000
2907	   status[211815] = 0b00110001
2908	   status[797182] = 0b00110010
2909	   status[582952] = 0b00110011
2910	   status[950870] = 0b00110100
2911	   status[765108] = 0b00110101
2912	   status[341110] = 0b00110110
2913	   status[776325] = 0b00110111
2914	   status[745056] = 0b00111000
2915	   status[439368] = 0b00111001
2916	   status[559893] = 0b00111010
2917	   status[149741] = 0b00111011
2918	   status[358903] = 0b00111100
2919	   status[513405] = 0b00111101
2920	   status[342679] = 0b00111110
2921	   status[969429] = 0b00111111
2922	   status[795775] = 0b01000000
2923	   status[566121] = 0b01000001
2924	   status[460566] = 0b01000010
2925	   status[680070] = 0b01000011
2926	   status[117310] = 0b01000100
2927	   status[480348] = 0b01000101
2928	   status[67319] = 0b01000110
2929	   status[661552] = 0b01000111
2930	   status[841303] = 0b01001000
2931	   status[561493] = 0b01001001
2932	   status[138807] = 0b01001010
2933	   status[442463] = 0b01001011
2934	   status[659927] = 0b01001100
2935	   status[445910] = 0b01001101
2936	   status[1046963] = 0b01001110
2937	   status[829700] = 0b01001111
2938	   status[962282] = 0b01010000
2939	   status[299623] = 0b01010001
2940	   status[555493] = 0b01010010
2941	   status[292826] = 0b01010011
2942	   status[517215] = 0b01010100
2943	   status[551009] = 0b01010101
2944	   status[898490] = 0b01010110
2945	   status[837603] = 0b01010111
2946	   status[759161] = 0b01011000
2947	   status[459948] = 0b01011001
2948	   status[290102] = 0b01011010
2949	   status[1034977] = 0b01011011
2950	   status[190650] = 0b01011100
2951	   status[98810] = 0b01011101
2952	   status[229950] = 0b01011110
2953	   status[320531] = 0b01011111
2954	   status[335506] = 0b01100000
2955	   status[885333] = 0b01100001
2956	   status[133227] = 0b01100010
2957	   status[806915] = 0b01100011
2958	   status[800313] = 0b01100100
2959	   status[981571] = 0b01100101
2960	   status[527253] = 0b01100110
2961	   status[24077] = 0b01100111
2962	   status[240232] = 0b01101000
2963	   status[559572] = 0b01101001
2964	   status[713399] = 0b01101010
2965	   status[233941] = 0b01101011
2966	   status[615514] = 0b01101100
2967	   status[911768] = 0b01101101
2968	   status[331680] = 0b01101110
2969	   status[951527] = 0b01101111
2970	   status[6805] = 0b01110000
2971	   status[552366] = 0b01110001
2972	   status[374660] = 0b01110010
2973	   status[223159] = 0b01110011
2974	   status[625884] = 0b01110100
2975	   status[417146] = 0b01110101
2976	   status[320527] = 0b01110110
2977	   status[784154] = 0b01110111
2978	   status[338792] = 0b01111000
2979	   status[1199] = 0b01111001
2980	   status[679804] = 0b01111010
2981	   status[1024680] = 0b01111011
2982	   status[40845] = 0b01111100
2983	   status[234603] = 0b01111101
2984	   status[761225] = 0b01111110
2985	   status[644903] = 0b01111111
2986	   status[502167] = 0b10000000
2987	   status[121477] = 0b10000001
2988	   status[505144] = 0b10000010
2989	   status[165165] = 0b10000011
2990	   status[179628] = 0b10000100
2991	   status[1019195] = 0b10000101
2992	   status[145149] = 0b10000110
2993	   status[263738] = 0b10000111
2994	   status[269256] = 0b10001000
2995	   status[996739] = 0b10001001
2996	   status[346296] = 0b10001010
2997	   status[555864] = 0b10001011
2998	   status[887384] = 0b10001100
2999	   status[444173] = 0b10001101
3000	   status[421844] = 0b10001110
3001	   status[653716] = 0b10001111
3002	   status[836747] = 0b10010000
3003	   status[783119] = 0b10010001
3004	   status[918762] = 0b10010010
3005	   status[946835] = 0b10010011
3006	   status[253764] = 0b10010100
3007	   status[519895] = 0b10010101
3008	   status[471224] = 0b10010110
3009	   status[134272] = 0b10010111
3010	   status[709016] = 0b10011000
3011	   status[44112] = 0b10011001
3012	   status[482585] = 0b10011010
3013	   status[461829] = 0b10011011
3014	   status[15080] = 0b10011100
3015	   status[148883] = 0b10011101
3016	   status[123467] = 0b10011110
3017	   status[480125] = 0b10011111
3018	   status[141348] = 0b10100000
3019	   status[65877] = 0b10100001
3020	   status[692958] = 0b10100010
3021	   status[148598] = 0b10100011
3022	   status[499131] = 0b10100100
3023	   status[584009] = 0b10100101
3024	   status[1017987] = 0b10100110
3025	   status[449287] = 0b10100111
3026	   status[277478] = 0b10101000
3027	   status[991262] = 0b10101001
3028	   status[509602] = 0b10101010
3029	   status[991896] = 0b10101011
3030	   status[853666] = 0b10101100
3031	   status[399318] = 0b10101101
3032	   status[197815] = 0b10101110
3033	   status[203278] = 0b10101111
3034	   status[903979] = 0b10110000
3035	   status[743015] = 0b10110001
3036	   status[888308] = 0b10110010
3037	   status[862143] = 0b10110011
3038	   status[979421] = 0b10110100
3039	   status[113605] = 0b10110101
3040	   status[206397] = 0b10110110
3041	   status[127113] = 0b10110111
3042	   status[844358] = 0b10111000
3043	   status[711569] = 0b10111001
3044	   status[229153] = 0b10111010
3045	   status[521470] = 0b10111011
3046	   status[401793] = 0b10111100
3047	   status[398896] = 0b10111101
3048	   status[940810] = 0b10111110
3049	   status[293983] = 0b10111111
3050	   status[884749] = 0b11000000
3051	   status[384802] = 0b11000001
3052	   status[584151] = 0b11000010
3053	   status[970201] = 0b11000011
3054	   status[523882] = 0b11000100
3055	   status[158093] = 0b11000101
3056	   status[929312] = 0b11000110
3057	   status[205329] = 0b11000111
3058	   status[106091] = 0b11001000
3059	   status[30949] = 0b11001001
3060	   status[195586] = 0b11001010
3061	   status[495723] = 0b11001011
3062	   status[348779] = 0b11001100
3063	   status[852312] = 0b11001101
3064	   status[1018463] = 0b11001110
3065	   status[1009481] = 0b11001111
3066	   status[448260] = 0b11010000
3067	   status[841042] = 0b11010001
3068	   status[122967] = 0b11010010
3069	   status[345269] = 0b11010011
3070	   status[794764] = 0b11010100
3071	   status[4520] = 0b11010101
3072	   status[818773] = 0b11010110
3073	   status[556171] = 0b11010111
3074	   status[954221] = 0b11011000
3075	   status[598210] = 0b11011001
3076	   status[887110] = 0b11011010
3077	   status[1020623] = 0b11011011
3078	   status[324632] = 0b11011100
3079	   status[398244] = 0b11011101
3080	   status[622241] = 0b11011110
3081	   status[456551] = 0b11011111
3082	   status[122648] = 0b11100000
3083	   status[127837] = 0b11100001
3084	   status[657676] = 0b11100010
3085	   status[119884] = 0b11100011
3086	   status[105156] = 0b11100100
3087	   status[999897] = 0b11100101
3088	   status[330160] = 0b11100110
3089	   status[119285] = 0b11100111
3090	   status[168005] = 0b11101000
3091	   status[389703] = 0b11101001
3092	   status[143699] = 0b11101010
3093	   status[142524] = 0b11101011
3094	   status[493258] = 0b11101100
3095	   status[846778] = 0b11101101
3096	   status[251420] = 0b11101110
3097	   status[516351] = 0b11101111
3098	   status[83344] = 0b11110000
3099	   status[171931] = 0b11110001
3100	   status[879178] = 0b11110010
3101	   status[663475] = 0b11110011
3102	   status[546865] = 0b11110100
3103	   status[428362] = 0b11110101
3104	   status[658891] = 0b11110110
3105	   status[500560] = 0b11110111
3106	   status[557034] = 0b11111000
3107	   status[830023] = 0b11111001
3108	   status[274471] = 0b11111010
3109	   status[629139] = 0b11111011
3110	   status[958869] = 0b11111100
3111	   status[663071] = 0b11111101
3112	   status[152133] = 0b11111110
3113	   status[19535] = 0b11111111

3115	   JSON encoding:

3117	   {
3118	     "bits": 8,
3119	     "lst": "eNrt0WOQM2kYhtGsbdu2bdu2bdu2bdu2bdu2jVnU1my
3120	     -SWYm6U5enFPVf7ue97orFYAo7CQBAACQuuckAABStqUEAAAAAAAAtN6wEgAE71QJA
3121	     AAAAIrwhwQAAAAAAdtAAgAAAAAAACLwkAQAAAAAAAAAAACUaFcJAACAeJwkAQAAAAA
3122	     AAABQvL4kAAAAWmJwCQAAAAAAAAjAwBIAAAB06ywJoDKQBARpfgkAAAAAAAAAAAAAA
3123	     AAAAACo50sJAAAAAAAAAOiRcSQAAAAAgAJNKgEAAG23mgQAAAAAAECw3pUAQvegBAA
3124	     AAAAAAADduE4CAAAAyjSvBAAQiw8koHjvSABAb-wlARCONyVoxtMSZOd0CQAAAOjWD
3125	     RKQmLckAAAAAACysLYEQGcnSAAAAAAQooUlAABI15kSAIH5RAIgLB9LABC4_SUgGZN
3126	     IAABAmM6RoLbTJIASzCIBAEAhfpcAAAAAAABquk8CAAAAAAAAaJl9SvvzBOICAFWmk
3127	     IBgfSgBAAAANOgrCQAAAAAAAADStK8EAAC03gASAAAAAAAAAADFWFUCAAAAMjOaBEA
3128	     DHpYAQjCIBADduFwCAAAAAGitMSSI3BUSAECOHpAA6IHrJQAAAAAAsjeVBAAAKRpVA
3129	     orWvwQAAAAAAAAAkKRtJAAAAAAAgCbcLAF0bXUJAAAAoF02kYDg7CYBAAAAAEB6NpQ
3130	     AAAAAAAAAAAAAAEr1uQQAAF06VgIAAAAAAAAAqDaeBAAQqgMkAAAAAABogQMlAAAAA
3131	     AAa87MEAAAQiwslAAAAAAAAAAAAAAAAMrOyBAAAiekv-hcsY0Sgne6QAAAAAAAgaUt
3132	     JAAAAAAAAAAAAAAAAAAAAAAAAAADwt-07vjVkAAAAgDy8KgFAUEaSAAAAAJL3vgQAW
3133	     dhcAgAAoBHDSUDo1pQAAACI2o4SAABZm14CALoyuwQAAPznGQkgZwdLAAAQukclAAA
3134	     AAAAAAAAAgKbMKgEAAAAAAAAAAAAAAAAAAECftpYAAAAAAAAAAAAACnaXBAAAAADk7
3135	     iMJAAAAAAAAAABqe00CAnGbBBG4TAIAgFDdKgFAXCaWAAAAAAAAAAAAAAAAAKAJQwR
3136	     72XbGAQAAAKAhh0sAAAAAAABQgO8kAAAAAAAAAAAAACAaM0kAAAC5W0QCAIJ3mAQAx
3137	     GwxCQAA6nhSAsjZBRIAANEbWQIAAAAAaJE3JACAwA0qAUBIVpKAlphbAiAPp0iQnKE
3138	     kAAAAAAAgBP1KAAAAdOl4CQAAAAAAAPjLZBIAAG10RtrPm8_CAEBMTpYAAAAAAIjQY
3139	     BL8z5QSAAAAAEDYPpUAACAsj0gAAADQkHMlAAjHDxIA0Lg9JQAAgHDsLQEAAABAQS6
3140	     WAAAAgLjNFs2l_RgLAIAEfCEBlGZZCQAAaIHjJACgtlskAAAozb0SAAAAVFtfAgAAA
3141	     AAAAAAAAAAAAAAAAAAAAKDDtxIAAAAAVZaTAKB5W0kAANCAsSUgJ0tL0GqHSNBbL0g
3142	     AZflRAgCARG0kQXNmlgCABiwkAQAAAEB25pIAAAAAAAAAAAAAoFh9SwAAAAAAADWNm
3143	     OSrpjFsEoaRgDKcF9Q1dxsEAAAAAAAAAAAAAAAAgPZ6SQIAAAAAAAAAgChMLgEAAAA
3144	     AAAAAqZlQAsK2qQQAAAAAAAD06XUJAAAAqG9bCQAAgLD9IgEAAAAAAAAAAAAAAAAAA
3145	     EBNe0gAAAAAAAAAAEBPHSEBAAAAlOZtCYA4fS8B0GFRCQAo0gISAOTgNwmC840EAAA
3146	     AAAAAAAAAAAAAAAAAUJydJfjXPBIAAAAAAAAAAAAAAABk6WwJAAAAAAAAAAAAAAAAq
3147	     G8UCQAAgPpOlAAAIA83SQAANWwc9HUjGAgAAAAAAACAusaSAAAAAAAAAAAAAAAAAAA
3148	     AAAAAAAAAqHKVBACQjxklAAAAAAAAAKBHxpQAAAAAACBME0lAdlaUAACyt7sEAAAA0
3149	     Nl0EgAAAAAAAAAAAABA-8wgAQAAAAAAAKU4SgKgUtlBAgAAAAAAAAAAgMCMLwEE51k
3150	     JICdzSgCJGl2CsE0tAQAA0L11JQAAAAAAAAjUOhIAAAAAAAAAAAAAAGTqeQkAAAAAA
3151	     AAAAAAAKM8SEjTrJwkAAAAAAACocqQEULgVJAAAACjDUxJUKgtKAAAAqbpRAgCA0n0
3152	     mAQAAAABAGzwmAUCTLpUAAAAAAAAAAEjZNRIAAAAAAAAAAAAAAAAAAAAA8I-vJaAlh
3153	     pQAAAAAAHrvzjJ-OqCuuVlLAojP8BJAr70sQZVDJYAgXS0BAAAAAAAAAAAAtMnyEgA
3154	     AAAAAFONKCQAAAAAAAADorc0kAAAAAAAAgDqOlgAAAAAAAAAAAADIwv0SAAAAAAAAA
3155	     AAAAADBuV0CIFVDSwAAAABAAI6RAAAAAGIwrQSEZAsJAABouRclAAAAAKDDrxIAAAA
3156	     0bkkJgFiMKwEAAAAAAHQyhwRk7h4JAAAAAAAAAAAgatdKAACUYj0JAAAAAAAAAAAAQ
3157	     nORBLTFJRIAAAAAkIaDJAAAAJryngQAAAAAAAAAAAA98oQEAAAAAAAAAEC2zpcgWY9
3158	     LQKL2kwAgGK9IAAAAAPHaRQIAAAAAAAAAAADIxyoSAAAAAAAAAAAAAADQFotLAECz_
3159	     gQ1PX-B"
3160	   }

3162	   CBOR encoding:

3164	   a2646269747308636c73745907b078daedd1639033691886d1ac6ddbb66ddbb66ddb
3165	   b66ddbb66ddbb68d59d4d66cbe496626e94e5e9c53d57fbb9ef7ba2b158028ec2401
3166	   000090bae724000052b6a504000000000000b4deb0120004ef5409000000008af087
3167	   040000000001db400200000000000022f09004000000000000000000946857090000
3168	   80789c24010000000000000050bcbe240000005a62700900000000000008c0c01200
3169	   000074eb2c09a032900404697e09000000000000000000000000000000a8e74b0900
3170	   000000000000e89171240000000080024d2a0100006db79a04000000000040b0de95
3171	   0042f7a00400000000000000ddb84e02000000ca34af0400108b0f24a078ef480040
3172	   6fec2501108e372568c6d31264e77409000000e8d60d129098b7240000000000b2b0
3173	   b604406727480000000010a28525000048d799120081f94402202c1f4b0010b8fd25
3174	   2019934800004098ce91a0b6d3248012cc22010040217e970000000000006aba4f02
3175	   00000000000068997d4afbf304e2020055a69080607d280100000034e82b09000000
3176	   00000000d2b4af040000b4de00120000000000000000c558550200000032339a0440
3177	   031e96004230880400ddb85c020000000068ad312488dc151200408e1e9000e881eb
3178	   250000000000b23795040000291a55028ad6bf040000000000000090a46d24000000
3179	   00008026dc2c01746d7509000000a05d369180e0ec260100000000407a3694000000
3180	   00000000000000004af5b90400005d3a560200000000000000a8369e040010aa0324
3181	   00000000006881032500000000001af3b3040000108b0b2500000000000000000000
3182	   000032b3b204000089e92ffa172c6344a09dee90000000000020694b490000000000
3183	   000000000000000000000000000000f0b7ed3bbe3564000000803cbc2a0140504692
3184	   0000000092f7be040059d85c020000a011c34940e8d69400000088da8e120000599b
3185	   5e0200ba32bb040000fce719092067074b000010ba472500000000000000000080a6
3186	   cc2a010000000000000000000000000000409fb696000000000000000000000a7697
3187	   0400000000e4ee230900000000000000006a7b4d0202719b0411b84c02008050dd2a
3188	   01405c269600000000000000000000000000a00943047bd976c601000000a021874b
3189	   0000000000005080ef2400000000000000000000201a3349000000b95b4402008277
3190	   980400c46c31090000ea785202c8d905120000d11b590200000000689137240080c0
3191	   0d2a01404856928096985b02200fa748909ca12400000000002004fd4a00000074e9
3192	   7809000000000000f8cb641200006d7446dacf9bcfc200404c4e96000000000088d0
3193	   6012fccf94120000000040d83e950000202c8f48000000d09073250008c70f1200d0
3194	   b83d2500008070ec2d0100000040412e9600000080b8cd16cda5fd180b0080047c21
3195	   019466590900006881e32400a0b65b24000028cdbd12000000545b5f020000000000
3196	   00000000000000000000000000a0c3b7120000000055969300a0795b490000d080b1
3197	   2520274b4bd06a8748d05b2f480065f951020080446d24417366960080062c240100
3198	   00004076e69200000000000000000000a0587d4b000000000000358d98e4aba6316c
3199	   12869180329c17d435771b0400000000000000000000000080f67a49020000000000
3200	   000080284c2e0100000000000000a9995002c2b6a904000000000000f4e975090000
3201	   00a86f5b09000080b0fd22010000000000000000000000000000404d7b4800000000
3202	   00000000404f1d210100000094e66d0980387d2f01d06151090028d2021200e4e037
3203	   0982f38d04000000000000000000000000000000509c9d25f8d73c12000000000000
3204	   00000000000064e96c09000000000000000000000000a86f1409000080fa4e940000
3205	   200f37490000356c1cf47523180800000000000080bac69200000000000000000000
3206	   0000000000000000000000a872950400908f192500000000000000a047c694000000
3207	   0000204c1349407656940000b2b7bb04000000d0d974120000000000000000000040
3208	   fbcc2001000000000000a5384a02a052d94102000000000000000080c08c2f0104e7
3209	   59092027734a00891a5d82b04d2d010000d0bd752500000000000008d43a12000000
3210	   000000000000000064ea79090000000000000000000028cf121234eb270900000000
3211	   0000a872a40450b8152400000028c35312542a0b4a000000a9ba51020080d27d2601
3212	   00000000401b3c260140932e95000000000000000048d93512000000000000000000
3213	   00000000000000f08faf25a025869400000000007aefce327e3aa0aeb9594b0288cf
3214	   f01240afbd2c4195432580205d2d01000000000000000000b4c9f212000000000014
3215	   e34a0900000000000000e8adcd24000000000000803a8e9600000000000000000000
3216	   c8c2fd120000000000000000000000c1b95d022055434b0000000040008e91000000
3217	   006230ad0484640b09000068b9172500000000a0c3af12000000346e490980588c2b
3218	   0100000000007432870464ee1e090000000000000000206ad74a000094623d090000
3219	   0000000000000042739104b4c5251200000000908683240000009af29e0400000000
3220	   00000000003df284040000000000000040b6ce9720598f4b40a2f693002018af4800
3221	   000000f1da4502000000000000000000c8c72a120000000000000000000000d0168b
3222	   4b0040b3fe04353d7f81

3224	Document History

3226	   [[ To be removed from the final specification ]]

3228	   -15

3230	   *  limit Status List Token CWT COSE message to Sign1/Mac0

3232	   *  be explicit about tagging and re-add cose_sign1 tag to example

3234	   *  add description field to EKU iana registration request

3236	   *  fix typos in referenced token

3238	   *  fix typos

3240	   *  make IANA references informative

3242	   *  remove unused iana.jose reference

3244	   -14

3246	   *  use binary value encoding for all test vectors (display purposes
3247	      only)

3249	   *  removed bytes from graphic that were intepreted as padding bytes

3251	   *  removed 0x0B from application-specific Status Type

3253	   *  reemphasized that expired tokens with status "VALID" are still
3254	      expired

3256	   *  renamed section "Status List Aggregation in JSON Format" to
3257	      "Status List Aggregation Data Structure"

3259	   *  slightly restructure/clarify referenced token cose section
3260	   *  Add ASN.1 module

3262	   *  many nits and improvements from genart review

3264	   *  remove cose_sign1 tag from statuslist in cwt form examples

3266	   *  slightly restructure/clarify referenced token cose section

3268	   *  Add ASN.1 module

3270	   *  removed DL suspension example

3272	   -13

3274	   *  add definition of client to terminology

3276	   *  Make exp and ttl recommended in claim description (fixes
3277	      inconsistency, was recommended in other text)

3279	   *  Add short security consideraiton on redirects and ttl

3281	   *  fix CORS spec to specific version

3283	   *  explain KYC

3285	   *  link implementation guidance to exp and ttl in Status List Token
3286	      definition

3288	   *  reference RFC7515 instead of IANA:JOSE

3290	   *  add a note that cwt is encoded in raw/binary.

3292	   *  added further privacy consideration around issuer tracking using
3293	      unique URIs

3295	   -12

3297	   *  Allow for extended key usage OID to be used for other status
3298	      mechanisms

3300	   *  add Paul's affiliation

3302	   *  add feedback from Dan Moore

3304	   *  change JSON Status List structure to only contain JSON object

3306	   *  further nitpicks
3307	   *  clarifying status and status_list IANA descriptions for JWT/CWT

3309	   *  clarifying description texts for status and status_list in CBOR

3311	   *  splitting Linkability Mitigation from Token Lifecycle section in
3312	      Implementation Consideration

3314	   *  relax the accept header from must to should

3316	   -11

3318	   *  incorporate feedback from shepherd review

3320	   *  some nitpicks

3322	   *  even more nitpicks

3324	   -10

3326	   *  improve caching guidelines and move them to implementaiton
3327	      considerations

3329	   *  Add CoAP Content-Format ID and IANA registration

3331	   *  Add size comparison for status list and compressed uuids

3333	   *  Change Controller IESG for OAuths Parameters Registration

3335	   -09

3337	   *  update acknowledgments

3339	   *  introduce dedicated section for compressed byte array of the
3340	      Status List

3342	   *  fix Status List definitions

3344	   *  Add CDDL for CBOR StatusList encoding

3346	   *  add diagram for Status List Aggregation for further explanation

3348	   *  rename "chunking" of Status List Tokens (for scalability reasons)
3349	      into "divide .. up"

3351	   -08

3353	   *  Fix cwt typ value to full media type
3354	   *  Holders may also fetch and verify Status List Tokens

3356	   *  Update terminology for referenced token and Status List Token

3358	   -07

3360	   *  add considerations about External Status Issuer or Status Provider

3362	   *  add recommendations for Key Resolution and Trust Management

3364	   *  add extended key usage extensions for x509

3366	   *  Relying Parties avoiding correlatable Information

3368	   *  editorial changes on terminology and Referenced Tokens

3370	   *  clarify privacy consideration around one time use referenced
3371	      tokens

3373	   *  explain the Status List Token size dependencies

3375	   *  explain possibility to chunk Status List Tokens depending on
3376	      Referenced Token's expiry date

3378	   *  add short-lived tokens in the Rationale

3380	   *  rename Status Mechanism Methods registry to Status Mechanisms
3381	      registry

3383	   *  changes as requested by IANA review

3385	   *  emphasize that security and privacy considerations only apply to
3386	      Status List and no other status mechanisms

3388	   *  differentiate unlinkability between Issuer-RP and RP-RP

3390	   *  add more test vectors for the status list encoding

3392	   *  add prior art

3394	   *  updated language around application specific status type values
3395	      and assigned ranges for application specific usage

3397	   *  add short security considerations section for mac based
3398	      deployments

3400	   *  privacy considerations for other status types like suspended
3401	   *  fix aggregation_uri text in referenced token

3403	   *  mention key resolution in validation rules

3405	   -06

3407	   *  iana registration text updated with update procedures

3409	   *  explicitly mention that status list is expected to be contained in
3410	      cryptographically secured containers

3412	   *  reworked and simplified introduction and abstract

3414	   *  specify http status codes and allow redirects

3416	   *  add status_list_aggregation_endpoint OAuth metadata

3418	   *  remove unsigned options (json/cbor) of status list

3420	   *  add section about mixing status list formats and media type

3422	   *  fixes from IETF review

3424	   *  update guidance around ttl

3426	   *  add guidance around aggregation endpoint

3428	   -05

3430	   *  add optional support for historical requests

3432	   *  update CBOR claim definitions

3434	   *  improve section on Status Types and introduce IANA registry for it

3436	   *  add Status Issuer and Status Provider role description to the
3437	      introduction/terminology

3439	   *  add information on third party hosting to security consideration

3441	   *  remove constraint that Status List Token must not use a MAC

3443	   -04

3445	   *  add mDL example as Referenced Token and consolidate CWT and CBOR
3446	      sections

3448	   *  add implementation consideration for Default Values, Double
3449	      Allocation and Status List Size

3451	   *  add privacy consideration on using private relay protocols

3453	   *  add privacy consideration on observability of outsiders

3455	   *  add security considerations on correct parsing and decoding

3457	   *  remove requirement for matching iss claim in Referenced Token and
3458	      Status List Token

3460	   *  add sd-jwt-vc example

3462	   *  fix CWT status_list map encoding

3464	   *  editorial fixes

3466	   *  add CORS considerations to the http endpoint

3468	   *  fix reference of Status List in CBOR format

3470	   *  added status_list CWT claim key assigned

3472	   *  move base64url definition to terminology

3474	   -03

3476	   *  remove unused reference to RFC9111

3478	   *  add validation rules for status list token

3480	   *  introduce the status list aggregation mechanism

3482	   *  relax requirements for status_list claims to contain other
3483	      parameters

3485	   *  change cwt referenced token example to hex and annotated hex

3487	   *  require TLS only for fetching Status List, not for Status List
3488	      Token

3490	   *  remove the undefined phrase Status List endpoint

3492	   *  remove http caching in favor of the new ttl claim

3494	   *  clarify the sub claim of Status List Token
3495	   *  relax status_list iss requirements for CWT

3497	   *  Fixes missing parts & iana ttl registration in CWT examples

3499	   -02

3501	   *  add ttl claim to Status List Token to convey caching

3503	   *  relax requirements on referenced token

3505	   *  clarify Deflate / zlib compression

3507	   *  make a reference to the Issuer-Holder-Verifier model of SD-JWT VC

3509	   *  add COSE/CWT/CBOR encoding

3511	   -01

3513	   *  Rename title of the draft

3515	   *  add design consideration to the introduction

3517	   *  Change status claim to in referenced token to allow re-use for
3518	      other mechanisms

3520	   *  Add IANA Registry for status mechanisms

3522	   *  restructure the sections of this document

3524	   *  add option to return an unsigned Status List

3526	   *  Changing compression from gzip to zlib

3528	   *  Change typo in Status List Token sub claim description

3530	   *  Add access token as an example use-case

3532	   -00

3534	   *  Initial draft after working group adoption

3536	   *  update acknowledgments

3538	   *  renamed Verifier to Relying Party

3540	   *  added IANA consideration

3542	   [ draft-ietf-oauth-status-list ]
3543	   -01

3545	   *  Applied editorial improvements suggested by Michael Jones.

3547	   -00

3549	   *  Initial draft

3551	Authors' Addresses

3553	   Tobias Looker
3554	   MATTR
3555	   Email: tobias.looker@mattr.global

3557	   Paul Bastian
3558	   Bundesdruckerei
3559	   Email: paul.bastian@posteo.de

3561	   Christian Bormann
3562	   SPRIND
3563	   Email: chris.bormann@gmx.de









